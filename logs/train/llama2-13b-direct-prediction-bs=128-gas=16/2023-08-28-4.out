nohup: ignoring input
[2023-08-28 22:22:09,636] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[2023-08-28 22:22:13,699] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-08-28 22:22:13,714] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-08-28 22:22:13,796] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-08-28 22:22:13,801] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-08-28 22:22:14,951] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-08-28 22:22:14,951] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-08-28 22:22:14,955] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-08-28 22:22:14,955] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-08-28 22:22:15,078] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-08-28 22:22:15,078] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-08-28 22:22:15,157] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-08-28 22:22:15,157] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-08-28 22:22:15,157] [INFO] [comm.py:643:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
08/28/2023 22:22:16 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 2
Local process index: 2
Device: cuda:2

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

08/28/2023 22:22:16 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

08/28/2023 22:22:16 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 3
Local process index: 3
Device: cuda:3

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

08/28/2023 22:22:16 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 1
Local process index: 1
Device: cuda:1

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

loading configuration file /data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936/config.json
Model config LlamaConfig {
  "_name_or_path": "/data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 5120,
  "initializer_range": 0.02,
  "intermediate_size": 13824,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 40,
  "num_hidden_layers": 40,
  "num_key_value_heads": 40,
  "pad_token_id": 0,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "tie_word_embeddings": false,
  "torch_dtype": "float16",
  "transformers_version": "4.31.0",
  "use_cache": true,
  "vocab_size": 32000
}

loading file tokenizer.model
loading file added_tokens.json
loading file special_tokens_map.json
loading file tokenizer_config.json
loading weights file /data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936/model.safetensors.index.json
Detected DeepSpeed ZeRO-3: activating zero.init() for this model
Generate config GenerationConfig {
  "_from_model_config": true,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.31.0"
}

[2023-08-28 22:22:21,046] [INFO] [partition_parameters.py:326:__exit__] finished initializing model with 13.02B parameters
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.16it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.13it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.12it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:02,  2.15s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:02,  2.15s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:02,  2.15s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.90s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.57s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.91s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.57s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.91s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.58s/it]
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.27s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.50s/it]
All model checkpoint weights were used when initializing LlamaForCausalLM.

All the weights of LlamaForCausalLM were initialized from the model checkpoint at /data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.
Generation config file not found, using a generation config created from the model config.
Assigning <s> to the bos_token key of the tokenizer
Assigning </s> to the eos_token key of the tokenizer
Assigning <unk> to the unk_token key of the tokenizer
Assigning <pad> to the pad_token key of the tokenizer
Adding <pad> to the vocabulary
08/28/2023 22:22:37 - INFO - __main__ - Sample 45281 of the training set: {'input_ids': tensor([    1,  2803,   395, 29909,   353,   313, 29900, 29892, 29871, 29900,
          511, 29938,   395, 29933,   353,   313, 29896, 29892, 29871, 29906,
          511, 29938,   395, 29907,  7607, 29941, 29892, 29871, 29941,   511,
        29938,   322,   395, 29928,   353,   313, 29946, 29892, 29871, 29900,
          467, 29938,   751,   328,  4115,  1008,   284,   395,  2882,  6530,
        29938,   338,  5700,   964,  1023, 12785,   411,   278,  1021,  4038,
          491,   263,  1196,  6819,  1549,   395, 29909,  7449,  1724,   526,
          278, 10350,   310,   278,  1298,   988,   445,  1196, 25869, 29879,
          779,  6875, 29912,  6530,  1042, 29973,    13, 29902,  8369,   393,
          278, 18890,  4115,  1008,   284,   395,  2882,  6530, 29938,   338,
          263,  1020,   412,  2502,   333, 29892,   411, 22561,   779,  6875,
        29912,  2882,  1042,   322,   779,  6875, 29912,  6530,  1042,   322,
         3171, 29871, 29941, 29889,    13]), 'labels': tensor([-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, 8178]), 'attention_mask': tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1])}.
08/28/2023 22:22:37 - INFO - __main__ - Sample 29666 of the training set: {'input_ids': tensor([    1,   960,   395, 29916, 29938,   338,   385,  7736,  1353, 29892,
          769,  1284,   278, 10150,  6043,   393,  2337,  1933,  2247,   278,
         4603, 29905, 15625, 29896, 29900, 29916, 29974, 29906,  5033, 29896,
        29900, 29916, 29974, 29953,  5033, 29945, 29916, 29974, 29945,  2144,
        29962,    13, 29902,  8369,   393,   278,  4603,   338,   263,  3234,
          310,  2211, 13879, 29892,   577,   306,  4997,   565,   306,   508,
         7329,   714,   777,  3619,  8572,   943,   515,  1269,  7329, 29889,
           13, 29902,  1074,   393,  1269,  7329,   756,   263,  4868,  1840,
          393,   338,  1584, 29892,   577,   306,   508,  7329,   714,   263,
        29871, 29906,   515,  1269,  7329, 29892,   322,   679, 29905,  7110,
         1154,  8001, 29896, 29900, 29916, 29974, 29906,  5033, 29896, 29900,
        29916, 29974, 29953,  5033, 29945, 29916, 29974, 29945, 10172, 29947,
         5369, 29898, 29945, 29916, 29974, 29896,  5033, 29945, 29916, 29974,
        29941,  5033, 29945, 29916, 29974, 29945,  2144, 29962,    13]), 'labels': tensor([-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 6374, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, 8178]), 'attention_mask': tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])}.
08/28/2023 22:22:37 - INFO - __main__ - Sample 65290 of the training set: {'input_ids': tensor([    1,   450,  2533,   310,   278,   395, 29916,  4388,  1111, 24266,
          310,   278, 13791,   310,   263, 17205,   297,   278, 12370, 18970,
        10694, 15743,   779,  3676, 29912, 29896, 29941,  4311, 29871,  2803,
          395, 29903, 29938,  5186,   278,  2533,   310,   278,   395, 29916,
         4388,  1111, 24266,   310,   278,  7145,  9748,   310,   278, 11192,
          310,   278, 17205, 29889, 10987,   395, 29903, 29985, 29906,  1504,
           13, 29902,   817,   304,  1284,   278,  2533,   310,   278,   395,
        29916,  4388,  1111, 24266,   310,   278,  7145,  9748,   310,   278,
        11192,   310,   278, 17205, 29892,   322,   769,  6862,   372, 29889,
           13,  7058,  2444,   763,   263,  3287,   310,   664, 29892,   577,
          306,  4997,   565,   727,   338,   263, 21697, 29889,    13, 29902,
        17386,   393,   278,  7145,  3149,   310,   263,  1196, 10768,   756,
          278,  6588,   310,   278,   395, 29916,  4388,  1111, 24266,   310,
          278,  1095,  9748, 29889,    13,  6295, 29892,   565,   306,   505,
          263,  2625,   411,  1095,  9748,  2427, 29874, 29892, 29890,  1262,
          322,  2427, 29883, 29892, 29881,  5767,   278,  7145,  3149,   756,
          278,   395, 29916,  4388, 29302,  2427, 29874, 29974, 29883,  6802,
        29906,  1504,    13,  7058,  2794,   393,   565,   306,   788,   701,
          278,   395, 29916,  4388,  1111, 24266,   310,   278,  7145,  9748,
          310,   278,  2211, 11192, 29892,   306,   679,  4203,   310,   278,
         2533,   310,   278,   395, 29916,  4388,  1111, 24266,   310,   278,
        13791, 29889,    13]), 'labels': tensor([-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, 6374, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        6374, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, 8178]), 'attention_mask': tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])}.
08/28/2023 22:22:37 - INFO - accelerate.accelerator - Updating DeepSpeed's gradient accumulation steps to 16 from 1.
[2023-08-28 22:22:37,178] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.10.0, git-hash=unknown, git-branch=unknown
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 0
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 1
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 3
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 2
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Rank 2: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Rank 1: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
08/28/2023 22:22:37 - INFO - torch.distributed.distributed_c10d - Rank 3: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
[2023-08-28 22:22:37,998] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-28 22:22:37,999] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the client Optimizer
[2023-08-28 22:22:37,999] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2023-08-28 22:22:38,015] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2023-08-28 22:22:38,015] [INFO] [utils.py:54:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2023-08-28 22:22:38,015] [INFO] [logging.py:96:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[2023-08-28 22:22:38,015] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 3 optimizer
[2023-08-28 22:22:38,147] [INFO] [utils.py:785:see_memory_usage] Stage 3 initialize beginning
[2023-08-28 22:22:38,148] [INFO] [utils.py:786:see_memory_usage] MA 6.75 GB         Max_MA 7.44 GB         CA 8.76 GB         Max_CA 9 GB 
[2023-08-28 22:22:38,148] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 91.64 GB, percent = 9.1%
[2023-08-28 22:22:38,149] [INFO] [stage3.py:117:__init__] Reduce bucket size 26214400
[2023-08-28 22:22:38,149] [INFO] [stage3.py:118:__init__] Prefetch bucket size 23592960
[2023-08-28 22:22:38,235] [INFO] [utils.py:785:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[2023-08-28 22:22:38,236] [INFO] [utils.py:786:see_memory_usage] MA 6.75 GB         Max_MA 6.75 GB         CA 8.76 GB         Max_CA 9 GB 
[2023-08-28 22:22:38,236] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 91.65 GB, percent = 9.1%
Parameter Offload: Total persistent parameters: 414720 in 81 params
[2023-08-28 22:22:38,334] [INFO] [utils.py:785:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[2023-08-28 22:22:38,335] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.83 GB         CA 8.76 GB         Max_CA 9 GB 
[2023-08-28 22:22:38,335] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 91.64 GB, percent = 9.1%
[2023-08-28 22:22:38,416] [INFO] [utils.py:785:see_memory_usage] Before creating fp16 partitions
[2023-08-28 22:22:38,417] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.29 GB         CA 8.76 GB         Max_CA 9 GB 
[2023-08-28 22:22:38,417] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 91.64 GB, percent = 9.1%
[2023-08-28 22:22:42,721] [INFO] [utils.py:785:see_memory_usage] After creating fp16 partitions: 4
[2023-08-28 22:22:42,722] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.29 GB         CA 6.89 GB         Max_CA 9 GB 
[2023-08-28 22:22:42,722] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 109.92 GB, percent = 10.9%
[2023-08-28 22:22:42,823] [INFO] [utils.py:785:see_memory_usage] Before creating fp32 partitions
[2023-08-28 22:22:42,824] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.29 GB         CA 6.89 GB         Max_CA 7 GB 
[2023-08-28 22:22:42,824] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 109.92 GB, percent = 10.9%
[2023-08-28 22:22:43,971] [INFO] [utils.py:785:see_memory_usage] After creating fp32 partitions
[2023-08-28 22:22:43,971] [INFO] [utils.py:786:see_memory_usage] MA 18.42 GB         Max_MA 19.43 GB         CA 21.9 GB         Max_CA 22 GB 
[2023-08-28 22:22:43,971] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 97.79 GB, percent = 9.7%
[2023-08-28 22:22:44,805] [INFO] [utils.py:785:see_memory_usage] Before initializing optimizer states
[2023-08-28 22:22:44,806] [INFO] [utils.py:786:see_memory_usage] MA 18.42 GB         Max_MA 18.42 GB         CA 21.9 GB         Max_CA 22 GB 
[2023-08-28 22:22:44,806] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 91.71 GB, percent = 9.1%
[2023-08-28 22:22:44,968] [INFO] [utils.py:785:see_memory_usage] After initializing optimizer states
[2023-08-28 22:22:44,969] [INFO] [utils.py:786:see_memory_usage] MA 42.66 GB         Max_MA 52.24 GB         CA 63.22 GB         Max_CA 63 GB 
[2023-08-28 22:22:44,969] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 91.7 GB, percent = 9.1%
[2023-08-28 22:22:45,029] [INFO] [stage3.py:424:_setup_for_real_optimizer] optimizer state initialized
[2023-08-28 22:22:45,179] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt...
[2023-08-28 22:22:45,180] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt...
[2023-08-28 22:22:45,181] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt...
[2023-08-28 22:22:45,188] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt.
[2023-08-28 22:22:45,188] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt...
[2023-08-28 22:22:45,189] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt.
[2023-08-28 22:22:45,190] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt...
[2023-08-28 22:22:45,190] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt.
[2023-08-28 22:22:45,190] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt...
[2023-08-28 22:22:45,196] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt.
[2023-08-28 22:22:45,197] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt.
[2023-08-28 22:22:45,198] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt.
[2023-08-28 22:22:45,265] [INFO] [utils.py:785:see_memory_usage] After initializing ZeRO optimizer
[2023-08-28 22:22:45,266] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt...
[2023-08-28 22:22:45,266] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt...
[2023-08-28 22:22:45,266] [INFO] [utils.py:786:see_memory_usage] MA 48.77 GB         Max_MA 49.38 GB         CA 70.96 GB         Max_CA 71 GB 
[2023-08-28 22:22:45,266] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 91.72 GB, percent = 9.1%
[2023-08-28 22:22:45,266] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt...
[2023-08-28 22:22:45,266] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2023-08-28 22:22:45,266] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2023-08-28 22:22:45,266] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2023-08-28 22:22:45,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[(0.9, 0.999)]
[2023-08-28 22:22:45,267] [INFO] [config.py:960:print] DeepSpeedEngine configuration:
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   amp_enabled .................. False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   amp_params ................... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   bfloat16_enabled ............. True
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   checkpoint_parallel_write_pipeline  False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   checkpoint_tag_validation_enabled  True
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   checkpoint_tag_validation_fail  False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f661e1de4d0>
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   communication_data_type ...... None
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   curriculum_enabled_legacy .... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   curriculum_params_legacy ..... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   data_efficiency_enabled ...... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   dataloader_drop_last ......... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   disable_allgather ............ False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   dump_state ................... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   dynamic_loss_scale_args ...... None
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_enabled ........... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_layer_num ......... 0
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_max_iter .......... 100
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_stability ......... 1e-06
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_tol ............... 0.01
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   eigenvalue_verbose ........... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   elasticity_enabled ........... False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   fp16_auto_cast ............... None
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   fp16_enabled ................. False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   fp16_master_weights_and_gradients  False
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   global_rank .................. 0
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   grad_accum_dtype ............. None
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   gradient_accumulation_steps .. 16
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   gradient_clipping ............ 1.0
[2023-08-28 22:22:45,268] [INFO] [config.py:964:print]   gradient_predivide_factor .... 1.0
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   initial_dynamic_scale ........ 1
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   load_universal_checkpoint .... False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   loss_scale ................... 1.0
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   memory_breakdown ............. False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   mics_hierarchial_params_gather  False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   mics_shard_size .............. -1
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   optimizer_legacy_fusion ...... False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   optimizer_name ............... None
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   optimizer_params ............. None
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   pld_enabled .................. False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   pld_params ................... False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   prescale_gradients ........... False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   scheduler_name ............... None
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   scheduler_params ............. None
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   sparse_attention ............. None
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   sparse_gradients_enabled ..... False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   steps_per_print .............. inf
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   train_batch_size ............. 128
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   train_micro_batch_size_per_gpu  2
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   use_node_local_storage ....... False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   wall_clock_breakdown ......... False
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   world_size ................... 4
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   zero_allow_untested_optimizer  True
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=26214400 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=23592960 param_persistence_threshold=51200 model_persistence_threshold=sys.maxsize max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=True stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   zero_enabled ................. True
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   zero_force_ds_cpu_optimizer .. True
[2023-08-28 22:22:45,269] [INFO] [config.py:964:print]   zero_optimization_stage ...... 3
[2023-08-28 22:22:45,269] [INFO] [config.py:950:print_user_config]   json = {
    "bf16": {
        "enabled": true
    }, 
    "zero_optimization": {
        "stage": 3, 
        "overlap_comm": true, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09, 
        "reduce_bucket_size": 2.621440e+07, 
        "stage3_prefetch_bucket_size": 2.359296e+07, 
        "stage3_param_persistence_threshold": 5.120000e+04, 
        "stage3_max_live_parameters": 1.000000e+09, 
        "stage3_max_reuse_distance": 1.000000e+09, 
        "stage3_gather_16bit_weights_on_model_save": true
    }, 
    "gradient_accumulation_steps": 16, 
    "gradient_clipping": 1.0, 
    "steps_per_print": inf, 
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 2, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
wandb: Currently logged in as: kidrain61. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.15.8
wandb: Run data is saved locally in /data/users/zhangjunlei/tyx/wandb/wandb/run-20230828_222246-07wmfj9w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 2023-08-28-4
wandb: ⭐️ View project at https://wandb.ai/kidrain61/open_instruct
wandb: 🚀 View run at https://wandb.ai/kidrain61/open_instruct/runs/07wmfj9w
08/28/2023 22:22:52 - INFO - __main__ - ***** Running training *****
08/28/2023 22:22:52 - INFO - __main__ -   Num examples = 87012
08/28/2023 22:22:52 - INFO - __main__ -   Num Epochs = 3
08/28/2023 22:22:52 - INFO - __main__ -   Instantaneous batch size per device = 2
08/28/2023 22:22:52 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 128
08/28/2023 22:22:52 - INFO - __main__ -   Gradient Accumulation steps = 16
08/28/2023 22:22:52 - INFO - __main__ -   Total optimization steps = 2040
  0%|          | 0/2040 [00:00<?, ?it/s]Resuming from checkpoint: /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300
08/28/2023 22:22:52 - INFO - accelerate.accelerator - Loading states from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300
08/28/2023 22:22:52 - INFO - accelerate.accelerator - Loading DeepSpeed Model and Optimizer
[2023-08-28 22:22:52,367] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2023-08-28 22:22:52,376] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2023-08-28 22:22:52,376] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2023-08-28 22:22:52,384] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2023-08-28 22:22:52,393] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2023-08-28 22:23:03,788] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt.
[2023-08-28 22:23:03,788] [INFO] [engine.py:2865:_get_all_zero_checkpoint_state_dicts] successfully read 4 ZeRO state_dicts for rank 1
[2023-08-28 22:23:05,044] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt.
[2023-08-28 22:23:05,045] [INFO] [engine.py:2865:_get_all_zero_checkpoint_state_dicts] successfully read 4 ZeRO state_dicts for rank 2
[2023-08-28 22:23:05,594] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt.
[2023-08-28 22:23:05,594] [INFO] [engine.py:2865:_get_all_zero_checkpoint_state_dicts] successfully read 4 ZeRO state_dicts for rank 3
[2023-08-28 22:23:12,662] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2023-08-28 22:23:12,662] [INFO] [engine.py:2865:_get_all_zero_checkpoint_state_dicts] successfully read 4 ZeRO state_dicts for rank 0
[2023-08-28 22:23:28,657] [INFO] [engine.py:2815:_load_zero_checkpoint] loading 4 zero partition checkpoints for rank 0
[2023-08-28 22:23:28,657] [INFO] [engine.py:2815:_load_zero_checkpoint] loading 4 zero partition checkpoints for rank 1
[2023-08-28 22:23:28,658] [INFO] [engine.py:2815:_load_zero_checkpoint] loading 4 zero partition checkpoints for rank 3
[2023-08-28 22:23:28,658] [INFO] [engine.py:2815:_load_zero_checkpoint] loading 4 zero partition checkpoints for rank 2
08/28/2023 22:23:30 - INFO - accelerate.accelerator - DeepSpeed Model and Optimizer loaded from input dir /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_300/pytorch_model
08/28/2023 22:23:30 - INFO - accelerate.checkpointing - All model weights loaded successfully
08/28/2023 22:23:30 - INFO - accelerate.checkpointing - All optimizer states loaded successfully
08/28/2023 22:23:30 - INFO - accelerate.checkpointing - All scheduler states loaded successfully
08/28/2023 22:23:30 - INFO - accelerate.checkpointing - All random states loaded successfully
08/28/2023 22:23:30 - INFO - accelerate.accelerator - Loading in 0 custom states
08/28/2023 22:23:30 - INFO - __main__ - len(train_dataloader) = 10877
08/28/2023 22:23:30 - INFO - __main__ - Resuming from epoch 0 and step 4800 with gas=16
  0%|          | 0/2040 [00:38<?, ?it/s]  0%|          | 8/2040 [00:38<00:27, 73.97it/s]  1%|          | 17/2040 [00:38<00:25, 80.70it/s]  1%|▏         | 26/2040 [00:38<00:24, 83.06it/s]  2%|▏         | 35/2040 [00:38<00:24, 83.17it/s]  2%|▏         | 44/2040 [00:38<00:23, 83.27it/s]  3%|▎         | 53/2040 [00:38<00:23, 83.65it/s]  3%|▎         | 62/2040 [00:38<00:23, 83.82it/s]  3%|▎         | 71/2040 [00:39<00:23, 83.72it/s]  4%|▍         | 80/2040 [00:39<00:23, 84.49it/s]  4%|▍         | 89/2040 [00:39<00:23, 83.57it/s]  5%|▍         | 98/2040 [00:39<00:23, 84.04it/s]  5%|▌         | 107/2040 [00:39<00:22, 85.41it/s]  6%|▌         | 116/2040 [00:39<00:22, 85.80it/s]  6%|▌         | 125/2040 [00:39<00:22, 85.88it/s]  7%|▋         | 134/2040 [00:39<00:22, 84.88it/s]  7%|▋         | 143/2040 [00:39<00:22, 85.52it/s]  7%|▋         | 152/2040 [00:39<00:22, 85.40it/s]  8%|▊         | 161/2040 [00:40<00:21, 85.45it/s]  8%|▊         | 170/2040 [00:40<00:21, 85.77it/s]  9%|▉         | 179/2040 [00:40<00:21, 85.48it/s]  9%|▉         | 188/2040 [00:40<00:21, 86.00it/s] 10%|▉         | 197/2040 [00:40<00:21, 85.77it/s] 10%|█         | 206/2040 [00:40<00:21, 85.97it/s] 11%|█         | 215/2040 [00:40<00:21, 85.94it/s] 11%|█         | 224/2040 [00:40<00:21, 85.98it/s] 11%|█▏        | 233/2040 [00:40<00:20, 86.41it/s] 12%|█▏        | 242/2040 [00:41<00:20, 86.35it/s] 12%|█▏        | 251/2040 [00:41<00:20, 85.38it/s] 13%|█▎        | 260/2040 [00:41<00:20, 85.43it/s] 13%|█▎        | 269/2040 [00:41<00:20, 85.01it/s] 14%|█▎        | 278/2040 [00:41<00:20, 85.08it/s] 14%|█▍        | 287/2040 [00:41<00:20, 85.98it/s] 15%|█▍        | 296/2040 [00:41<00:20, 86.38it/s] 15%|█▍        | 300/2040 [00:59<00:20, 86.38it/s][2023-08-28 22:23:53,546] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▍        | 301/2040 [01:01<22:03,  1.31it/s]08/28/2023 22:23:53 - INFO - __main__ -   Step: 301, LR: 1.7574532592218294e-05, Loss: 0.4932275712490082
[2023-08-28 22:24:08,516] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▍        | 302/2040 [01:16<43:29,  1.50s/it]08/28/2023 22:24:08 - INFO - __main__ -   Step: 302, LR: 1.7564426478019204e-05, Loss: 0.5375964641571045
[2023-08-28 22:24:27,612] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▍        | 303/2040 [01:35<1:18:44,  2.72s/it]08/28/2023 22:24:27 - INFO - __main__ -   Step: 303, LR: 1.7554320363820113e-05, Loss: 0.5967274904251099
[2023-08-28 22:24:42,069] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▍        | 304/2040 [01:49<1:49:15,  3.78s/it]08/28/2023 22:24:42 - INFO - __main__ -   Step: 304, LR: 1.754421424962102e-05, Loss: 0.5752389430999756
[2023-08-28 22:24:57,244] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▍        | 305/2040 [02:04<2:26:45,  5.08s/it]08/28/2023 22:24:57 - INFO - __main__ -   Step: 305, LR: 1.753410813542193e-05, Loss: 0.6105365753173828
[2023-08-28 22:25:14,675] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 306/2040 [02:22<3:16:40,  6.81s/it]08/28/2023 22:25:14 - INFO - __main__ -   Step: 306, LR: 1.752400202122284e-05, Loss: 0.5532768964767456
[2023-08-28 22:25:29,431] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 307/2040 [02:37<3:54:49,  8.13s/it]08/28/2023 22:25:29 - INFO - __main__ -   Step: 307, LR: 1.751389590702375e-05, Loss: 0.6689223647117615
[2023-08-28 22:25:44,511] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 308/2040 [02:52<4:33:16,  9.47s/it]08/28/2023 22:25:44 - INFO - __main__ -   Step: 308, LR: 1.750378979282466e-05, Loss: 0.598613977432251
[2023-08-28 22:25:58,255] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 309/2040 [03:05<4:59:42, 10.39s/it]08/28/2023 22:25:58 - INFO - __main__ -   Step: 309, LR: 1.749368367862557e-05, Loss: 0.548969030380249
[2023-08-28 22:26:12,290] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 310/2040 [03:19<5:24:17, 11.25s/it]08/28/2023 22:26:12 - INFO - __main__ -   Step: 310, LR: 1.748357756442648e-05, Loss: 0.5740242600440979
[2023-08-28 22:26:26,432] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 311/2040 [03:34<5:45:05, 11.98s/it]08/28/2023 22:26:26 - INFO - __main__ -   Step: 311, LR: 1.747347145022739e-05, Loss: 0.5819995999336243
[2023-08-28 22:26:47,646] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 312/2040 [03:55<6:55:15, 14.42s/it]08/28/2023 22:26:47 - INFO - __main__ -   Step: 312, LR: 1.74633653360283e-05, Loss: 0.5655322670936584
[2023-08-28 22:27:03,982] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 313/2040 [04:11<7:10:08, 14.94s/it]08/28/2023 22:27:03 - INFO - __main__ -   Step: 313, LR: 1.745325922182921e-05, Loss: 0.5478049516677856
[2023-08-28 22:27:21,424] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 314/2040 [04:29<7:30:07, 15.65s/it]08/28/2023 22:27:21 - INFO - __main__ -   Step: 314, LR: 1.7443153107630116e-05, Loss: 0.6335409879684448
[2023-08-28 22:27:38,636] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 315/2040 [04:46<7:42:45, 16.10s/it]08/28/2023 22:27:38 - INFO - __main__ -   Step: 315, LR: 1.7433046993431025e-05, Loss: 0.5984705686569214
[2023-08-28 22:27:55,221] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 15%|█▌        | 316/2040 [05:02<7:46:34, 16.24s/it]08/28/2023 22:27:55 - INFO - __main__ -   Step: 316, LR: 1.7422940879231937e-05, Loss: 0.5203951597213745
[2023-08-28 22:28:14,157] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 317/2040 [05:21<8:09:01, 17.03s/it]08/28/2023 22:28:14 - INFO - __main__ -   Step: 317, LR: 1.7412834765032846e-05, Loss: 0.6034518480300903
[2023-08-28 22:28:31,548] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 318/2040 [05:39<8:11:48, 17.14s/it]08/28/2023 22:28:31 - INFO - __main__ -   Step: 318, LR: 1.7402728650833755e-05, Loss: 0.6182574033737183
[2023-08-28 22:28:49,403] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 319/2040 [05:57<8:17:38, 17.35s/it]08/28/2023 22:28:49 - INFO - __main__ -   Step: 319, LR: 1.7392622536634665e-05, Loss: 0.5515893697738647
[2023-08-28 22:29:06,457] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 320/2040 [06:14<8:14:49, 17.26s/it]08/28/2023 22:29:06 - INFO - __main__ -   Step: 320, LR: 1.7382516422435577e-05, Loss: 0.5677827596664429
[2023-08-28 22:29:20,825] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 321/2040 [06:28<7:49:48, 16.40s/it]08/28/2023 22:29:20 - INFO - __main__ -   Step: 321, LR: 1.7372410308236486e-05, Loss: 0.5791281461715698
[2023-08-28 22:29:38,518] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 322/2040 [06:46<8:00:36, 16.79s/it]08/28/2023 22:29:38 - INFO - __main__ -   Step: 322, LR: 1.7362304194037395e-05, Loss: 0.6019175052642822
[2023-08-28 22:29:54,521] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 323/2040 [07:02<7:53:38, 16.55s/it]08/28/2023 22:29:54 - INFO - __main__ -   Step: 323, LR: 1.7352198079838304e-05, Loss: 0.5913127660751343
[2023-08-28 22:30:12,664] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 324/2040 [07:20<8:06:59, 17.03s/it]08/28/2023 22:30:12 - INFO - __main__ -   Step: 324, LR: 1.7342091965639213e-05, Loss: 0.5650204420089722
[2023-08-28 22:30:29,769] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 325/2040 [07:37<8:07:22, 17.05s/it]08/28/2023 22:30:29 - INFO - __main__ -   Step: 325, LR: 1.7331985851440122e-05, Loss: 0.645796537399292
[2023-08-28 22:30:43,775] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 326/2040 [07:51<7:41:01, 16.14s/it]08/28/2023 22:30:43 - INFO - __main__ -   Step: 326, LR: 1.732187973724103e-05, Loss: 0.5359990000724792
[2023-08-28 22:31:00,724] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 327/2040 [08:08<7:47:41, 16.38s/it]08/28/2023 22:31:00 - INFO - __main__ -   Step: 327, LR: 1.731177362304194e-05, Loss: 0.650374174118042
[2023-08-28 22:31:17,948] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 328/2040 [08:25<7:54:37, 16.63s/it]08/28/2023 22:31:17 - INFO - __main__ -   Step: 328, LR: 1.7301667508842853e-05, Loss: 0.6074985265731812
[2023-08-28 22:31:33,215] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 329/2040 [08:40<7:42:39, 16.22s/it]08/28/2023 22:31:33 - INFO - __main__ -   Step: 329, LR: 1.7291561394643762e-05, Loss: 0.6288484334945679
[2023-08-28 22:31:48,682] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 330/2040 [08:56<7:35:54, 16.00s/it]08/28/2023 22:31:48 - INFO - __main__ -   Step: 330, LR: 1.728145528044467e-05, Loss: 0.5064655542373657
[2023-08-28 22:32:05,939] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▌        | 331/2040 [09:13<7:46:25, 16.38s/it]08/28/2023 22:32:05 - INFO - __main__ -   Step: 331, LR: 1.727134916624558e-05, Loss: 0.6077249050140381
[2023-08-28 22:32:24,215] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▋        | 332/2040 [09:31<8:02:22, 16.95s/it]08/28/2023 22:32:24 - INFO - __main__ -   Step: 332, LR: 1.726124305204649e-05, Loss: 0.5812461376190186
[2023-08-28 22:32:45,806] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▋        | 333/2040 [09:53<8:41:44, 18.34s/it]08/28/2023 22:32:45 - INFO - __main__ -   Step: 333, LR: 1.72511369378474e-05, Loss: 0.5866248607635498
[2023-08-28 22:33:00,880] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▋        | 334/2040 [10:08<8:13:34, 17.36s/it]08/28/2023 22:33:00 - INFO - __main__ -   Step: 334, LR: 1.7241030823648307e-05, Loss: 0.5453267097473145
[2023-08-28 22:33:16,035] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▋        | 335/2040 [10:23<7:54:30, 16.70s/it]08/28/2023 22:33:16 - INFO - __main__ -   Step: 335, LR: 1.7230924709449217e-05, Loss: 0.553851306438446
[2023-08-28 22:33:32,921] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 16%|█▋        | 336/2040 [10:40<7:55:49, 16.75s/it]08/28/2023 22:33:32 - INFO - __main__ -   Step: 336, LR: 1.722081859525013e-05, Loss: 0.5210908651351929
[2023-08-28 22:33:46,609] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 337/2040 [10:54<7:29:26, 15.83s/it]08/28/2023 22:33:46 - INFO - __main__ -   Step: 337, LR: 1.7210712481051038e-05, Loss: 0.5508636236190796
[2023-08-28 22:34:03,011] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 338/2040 [11:10<7:33:59, 16.00s/it]08/28/2023 22:34:03 - INFO - __main__ -   Step: 338, LR: 1.7200606366851947e-05, Loss: 0.5510883927345276
[2023-08-28 22:34:20,192] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 339/2040 [11:27<7:43:44, 16.36s/it]08/28/2023 22:34:20 - INFO - __main__ -   Step: 339, LR: 1.7190500252652856e-05, Loss: 0.5739486217498779
[2023-08-28 22:34:36,789] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 340/2040 [11:44<7:45:30, 16.43s/it]08/28/2023 22:34:36 - INFO - __main__ -   Step: 340, LR: 1.7180394138453765e-05, Loss: 0.5557335615158081
[2023-08-28 22:34:54,181] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 341/2040 [12:01<7:53:24, 16.72s/it]08/28/2023 22:34:54 - INFO - __main__ -   Step: 341, LR: 1.7170288024254674e-05, Loss: 0.5925378203392029
[2023-08-28 22:35:10,555] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 342/2040 [12:18<7:50:12, 16.61s/it]08/28/2023 22:35:10 - INFO - __main__ -   Step: 342, LR: 1.7160181910055583e-05, Loss: 0.5398132801055908
[2023-08-28 22:35:25,889] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 343/2040 [12:33<7:39:03, 16.23s/it]08/28/2023 22:35:25 - INFO - __main__ -   Step: 343, LR: 1.7150075795856496e-05, Loss: 0.606274425983429
[2023-08-28 22:35:41,344] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 344/2040 [12:48<7:32:12, 16.00s/it]08/28/2023 22:35:41 - INFO - __main__ -   Step: 344, LR: 1.7139969681657405e-05, Loss: 0.6286557912826538
[2023-08-28 22:35:58,124] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 345/2040 [13:05<7:38:33, 16.23s/it]08/28/2023 22:35:58 - INFO - __main__ -   Step: 345, LR: 1.7129863567458314e-05, Loss: 0.5465084314346313
[2023-08-28 22:36:11,632] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 346/2040 [13:19<7:15:13, 15.42s/it]08/28/2023 22:36:11 - INFO - __main__ -   Step: 346, LR: 1.7119757453259223e-05, Loss: 0.5870341062545776
[2023-08-28 22:36:26,222] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 347/2040 [13:33<7:07:58, 15.17s/it]08/28/2023 22:36:26 - INFO - __main__ -   Step: 347, LR: 1.7109651339060132e-05, Loss: 0.5782659649848938
[2023-08-28 22:36:41,596] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 348/2040 [13:49<7:09:28, 15.23s/it]08/28/2023 22:36:41 - INFO - __main__ -   Step: 348, LR: 1.709954522486104e-05, Loss: 0.5761014223098755
[2023-08-28 22:36:56,634] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 349/2040 [14:04<7:07:36, 15.17s/it]08/28/2023 22:36:56 - INFO - __main__ -   Step: 349, LR: 1.708943911066195e-05, Loss: 0.610927939414978
[2023-08-28 22:37:12,464] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 350/2040 [14:20<7:12:54, 15.37s/it]08/28/2023 22:37:12 - INFO - __main__ -   Step: 350, LR: 1.707933299646286e-05, Loss: 0.6226619482040405
[2023-08-28 22:37:30,173] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 351/2040 [14:37<7:32:24, 16.07s/it]08/28/2023 22:37:30 - INFO - __main__ -   Step: 351, LR: 1.7069226882263772e-05, Loss: 0.5279622077941895
[2023-08-28 22:37:45,112] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 352/2040 [14:52<7:22:34, 15.73s/it]08/28/2023 22:37:45 - INFO - __main__ -   Step: 352, LR: 1.705912076806468e-05, Loss: 0.6176935434341431
[2023-08-28 22:38:01,906] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 353/2040 [15:09<7:31:16, 16.05s/it]08/28/2023 22:38:01 - INFO - __main__ -   Step: 353, LR: 1.704901465386559e-05, Loss: 0.6049624085426331
[2023-08-28 22:38:17,832] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 354/2040 [15:25<7:29:58, 16.01s/it]08/28/2023 22:38:17 - INFO - __main__ -   Step: 354, LR: 1.70389085396665e-05, Loss: 0.575478196144104
[2023-08-28 22:38:31,585] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 355/2040 [15:39<7:10:39, 15.33s/it]08/28/2023 22:38:31 - INFO - __main__ -   Step: 355, LR: 1.702880242546741e-05, Loss: 0.5300222635269165
[2023-08-28 22:38:45,577] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 17%|█▋        | 356/2040 [15:53<6:59:05, 14.93s/it]08/28/2023 22:38:45 - INFO - __main__ -   Step: 356, LR: 1.701869631126832e-05, Loss: 0.6640828847885132
[2023-08-28 22:39:00,423] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 357/2040 [16:08<6:58:07, 14.91s/it]08/28/2023 22:39:00 - INFO - __main__ -   Step: 357, LR: 1.7008590197069226e-05, Loss: 0.6045286059379578
[2023-08-28 22:39:16,273] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 358/2040 [16:23<7:05:48, 15.19s/it]08/28/2023 22:39:16 - INFO - __main__ -   Step: 358, LR: 1.6998484082870135e-05, Loss: 0.6134454011917114
[2023-08-28 22:39:32,803] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 359/2040 [16:40<7:16:49, 15.59s/it]08/28/2023 22:39:32 - INFO - __main__ -   Step: 359, LR: 1.6988377968671048e-05, Loss: 0.51767897605896
[2023-08-28 22:39:48,928] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 360/2040 [16:56<7:21:02, 15.75s/it]08/28/2023 22:39:48 - INFO - __main__ -   Step: 360, LR: 1.6978271854471957e-05, Loss: 0.6492008566856384
[2023-08-28 22:40:04,577] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 361/2040 [17:12<7:19:55, 15.72s/it]08/28/2023 22:40:04 - INFO - __main__ -   Step: 361, LR: 1.6968165740272866e-05, Loss: 0.5328283309936523
[2023-08-28 22:40:22,283] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 362/2040 [17:29<7:36:18, 16.32s/it]08/28/2023 22:40:22 - INFO - __main__ -   Step: 362, LR: 1.6958059626073775e-05, Loss: 0.480582594871521
[2023-08-28 22:40:39,134] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 363/2040 [17:46<7:40:31, 16.48s/it]08/28/2023 22:40:39 - INFO - __main__ -   Step: 363, LR: 1.6947953511874688e-05, Loss: 0.5216630697250366
[2023-08-28 22:40:55,458] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 364/2040 [18:03<7:38:58, 16.43s/it]08/28/2023 22:40:55 - INFO - __main__ -   Step: 364, LR: 1.6937847397675597e-05, Loss: 0.5548715591430664
[2023-08-28 22:41:09,143] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 365/2040 [18:16<7:15:42, 15.61s/it]08/28/2023 22:41:09 - INFO - __main__ -   Step: 365, LR: 1.6927741283476506e-05, Loss: 0.6634092330932617
[2023-08-28 22:41:25,291] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 366/2040 [18:32<7:19:57, 15.77s/it]08/28/2023 22:41:25 - INFO - __main__ -   Step: 366, LR: 1.6917635169277415e-05, Loss: 0.5944159030914307
[2023-08-28 22:41:41,631] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 367/2040 [18:49<7:24:28, 15.94s/it]08/28/2023 22:41:41 - INFO - __main__ -   Step: 367, LR: 1.6907529055078324e-05, Loss: 0.6226105690002441
[2023-08-28 22:41:55,439] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 368/2040 [19:03<7:06:22, 15.30s/it]08/28/2023 22:41:55 - INFO - __main__ -   Step: 368, LR: 1.6897422940879233e-05, Loss: 0.5425251722335815
[2023-08-28 22:42:10,417] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 369/2040 [19:18<7:03:25, 15.20s/it]08/28/2023 22:42:10 - INFO - __main__ -   Step: 369, LR: 1.6887316826680142e-05, Loss: 0.5369968414306641
[2023-08-28 22:42:27,443] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 370/2040 [19:35<7:18:23, 15.75s/it]08/28/2023 22:42:27 - INFO - __main__ -   Step: 370, LR: 1.687721071248105e-05, Loss: 0.5349205136299133
[2023-08-28 22:42:42,015] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 371/2040 [19:49<7:08:17, 15.40s/it]08/28/2023 22:42:42 - INFO - __main__ -   Step: 371, LR: 1.6867104598281963e-05, Loss: 0.6423096656799316
[2023-08-28 22:42:58,573] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 372/2040 [20:06<7:17:42, 15.75s/it]08/28/2023 22:42:58 - INFO - __main__ -   Step: 372, LR: 1.6856998484082873e-05, Loss: 0.5578708648681641
[2023-08-28 22:43:14,958] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 373/2040 [20:22<7:22:47, 15.94s/it]08/28/2023 22:43:14 - INFO - __main__ -   Step: 373, LR: 1.684689236988378e-05, Loss: 0.5521330833435059
[2023-08-28 22:43:29,419] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 374/2040 [20:37<7:10:13, 15.49s/it]08/28/2023 22:43:29 - INFO - __main__ -   Step: 374, LR: 1.683678625568469e-05, Loss: 0.5345007181167603
[2023-08-28 22:43:45,966] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 375/2040 [20:53<7:18:43, 15.81s/it]08/28/2023 22:43:45 - INFO - __main__ -   Step: 375, LR: 1.68266801414856e-05, Loss: 0.5540438294410706
[2023-08-28 22:44:03,512] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 376/2040 [21:11<7:32:54, 16.33s/it]08/28/2023 22:44:03 - INFO - __main__ -   Step: 376, LR: 1.681657402728651e-05, Loss: 0.6047259569168091
[2023-08-28 22:44:20,348] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 18%|█▊        | 377/2040 [21:27<7:36:49, 16.48s/it]08/28/2023 22:44:20 - INFO - __main__ -   Step: 377, LR: 1.6806467913087418e-05, Loss: 0.5698011517524719
[2023-08-28 22:44:37,239] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▊        | 378/2040 [21:44<7:39:57, 16.61s/it]08/28/2023 22:44:37 - INFO - __main__ -   Step: 378, LR: 1.679636179888833e-05, Loss: 0.536733090877533
[2023-08-28 22:44:51,960] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▊        | 379/2040 [21:59<7:24:02, 16.04s/it]08/28/2023 22:44:51 - INFO - __main__ -   Step: 379, LR: 1.678625568468924e-05, Loss: 0.6412197351455688
[2023-08-28 22:45:08,328] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▊        | 380/2040 [22:15<7:26:29, 16.14s/it]08/28/2023 22:45:08 - INFO - __main__ -   Step: 380, LR: 1.677614957049015e-05, Loss: 0.565261960029602
[2023-08-28 22:45:25,729] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▊        | 381/2040 [22:33<7:36:41, 16.52s/it]08/28/2023 22:45:25 - INFO - __main__ -   Step: 381, LR: 1.6766043456291058e-05, Loss: 0.5841257572174072
[2023-08-28 22:45:43,194] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▊        | 382/2040 [22:50<7:44:16, 16.80s/it]08/28/2023 22:45:43 - INFO - __main__ -   Step: 382, LR: 1.6755937342091967e-05, Loss: 0.5917445421218872
[2023-08-28 22:46:00,625] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 383/2040 [23:08<7:49:13, 16.99s/it]08/28/2023 22:46:00 - INFO - __main__ -   Step: 383, LR: 1.6745831227892876e-05, Loss: 0.5680559277534485
[2023-08-28 22:46:16,660] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 384/2040 [23:24<7:41:01, 16.70s/it]08/28/2023 22:46:16 - INFO - __main__ -   Step: 384, LR: 1.6735725113693785e-05, Loss: 0.5658973455429077
[2023-08-28 22:46:31,938] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 385/2040 [23:39<7:28:57, 16.28s/it]08/28/2023 22:46:31 - INFO - __main__ -   Step: 385, LR: 1.6725618999494694e-05, Loss: 0.5730501413345337
[2023-08-28 22:46:49,683] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 386/2040 [23:57<7:40:49, 16.72s/it]08/28/2023 22:46:49 - INFO - __main__ -   Step: 386, LR: 1.6715512885295606e-05, Loss: 0.5871801376342773
[2023-08-28 22:47:04,789] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 387/2040 [24:12<7:27:14, 16.23s/it]08/28/2023 22:47:04 - INFO - __main__ -   Step: 387, LR: 1.6705406771096515e-05, Loss: 0.6354016065597534
[2023-08-28 22:47:19,545] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 388/2040 [24:27<7:14:45, 15.79s/it]08/28/2023 22:47:19 - INFO - __main__ -   Step: 388, LR: 1.6695300656897425e-05, Loss: 0.5357199907302856
[2023-08-28 22:47:34,146] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 389/2040 [24:41<7:04:40, 15.43s/it]08/28/2023 22:47:34 - INFO - __main__ -   Step: 389, LR: 1.6685194542698334e-05, Loss: 0.5031635761260986
[2023-08-28 22:47:50,463] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 390/2040 [24:58<7:11:42, 15.70s/it]08/28/2023 22:47:50 - INFO - __main__ -   Step: 390, LR: 1.6675088428499243e-05, Loss: 0.5403265953063965
[2023-08-28 22:48:06,737] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 391/2040 [25:14<7:16:11, 15.87s/it]08/28/2023 22:48:06 - INFO - __main__ -   Step: 391, LR: 1.6664982314300152e-05, Loss: 0.5630209445953369
[2023-08-28 22:48:22,145] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 392/2040 [25:29<7:12:06, 15.73s/it]08/28/2023 22:48:22 - INFO - __main__ -   Step: 392, LR: 1.665487620010106e-05, Loss: 0.5872519016265869
[2023-08-28 22:48:35,910] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 393/2040 [25:43<6:55:38, 15.14s/it]08/28/2023 22:48:35 - INFO - __main__ -   Step: 393, LR: 1.664477008590197e-05, Loss: 0.558186411857605
[2023-08-28 22:48:50,666] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 394/2040 [25:58<6:52:13, 15.03s/it]08/28/2023 22:48:50 - INFO - __main__ -   Step: 394, LR: 1.6634663971702882e-05, Loss: 0.5388123989105225
[2023-08-28 22:49:05,275] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 395/2040 [26:12<6:48:32, 14.90s/it]08/28/2023 22:49:05 - INFO - __main__ -   Step: 395, LR: 1.662455785750379e-05, Loss: 0.5489356517791748
[2023-08-28 22:49:22,258] [WARNING] [stage3.py:1898:step] 4 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 396/2040 [26:29<7:05:24, 15.53s/it]08/28/2023 22:49:22 - INFO - __main__ -   Step: 396, LR: 1.66144517433047e-05, Loss: 0.4986113905906677
[2023-08-28 22:49:38,588] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 19%|█▉        | 397/2040 [26:46<7:11:45, 15.77s/it]08/28/2023 22:49:38 - INFO - __main__ -   Step: 397, LR: 1.660434562910561e-05, Loss: 0.5497417449951172
[2023-08-28 22:49:54,909] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 398/2040 [27:02<7:16:02, 15.93s/it]08/28/2023 22:49:54 - INFO - __main__ -   Step: 398, LR: 1.6594239514906522e-05, Loss: 0.48413553833961487
[2023-08-28 22:50:12,551] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 399/2040 [27:20<7:29:47, 16.45s/it]08/28/2023 22:50:12 - INFO - __main__ -   Step: 399, LR: 1.658413340070743e-05, Loss: 0.6261014342308044
[2023-08-28 22:50:28,699] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 400/2040 [27:36<7:27:04, 16.36s/it]08/28/2023 22:50:28 - INFO - __main__ -   Step: 400, LR: 1.6574027286508337e-05, Loss: 0.5398683547973633
08/28/2023 22:50:28 - INFO - accelerate.accelerator - Saving current state to /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400
08/28/2023 22:50:28 - INFO - accelerate.accelerator - Saving DeepSpeed Model and Optimizer
[2023-08-28 22:50:28,708] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint pytorch_model is about to be saved!
/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2023-08-28 22:50:28,715] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt...
[2023-08-28 22:50:28,715] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt
[2023-08-28 22:50:28,715] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt...
[2023-08-28 22:50:28,715] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt...
[2023-08-28 22:50:28,716] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt
[2023-08-28 22:50:28,716] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2023-08-28 22:50:28,729] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt.
[2023-08-28 22:50:28,729] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt.
[2023-08-28 22:50:28,730] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt.
[2023-08-28 22:50:28,731] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2023-08-28 22:50:28,731] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt...
[2023-08-28 22:50:28,731] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2023-08-28 22:50:28,731] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt...
[2023-08-28 22:50:28,731] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt...
[2023-08-28 22:51:21,858] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt.
[2023-08-28 22:51:21,858] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt
[2023-08-28 22:51:23,866] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2023-08-28 22:51:23,867] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2023-08-28 22:51:28,037] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt.
[2023-08-28 22:51:28,037] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt
[2023-08-28 22:51:28,948] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt.
[2023-08-28 22:51:28,949] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt
[2023-08-28 22:51:28,954] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 22:51:28,954] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 22:51:28,954] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 22:51:28,955] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
08/28/2023 22:51:28 - INFO - accelerate.accelerator - DeepSpeed Model and Optimizer saved to output dir /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/pytorch_model
08/28/2023 22:51:28 - INFO - accelerate.checkpointing - Scheduler state saved in /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/scheduler.bin
08/28/2023 22:51:28 - INFO - accelerate.checkpointing - Random states saved in /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_400/random_states_0.pkl
[2023-08-28 22:51:46,361] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 401/2040 [28:53<15:49:12, 34.75s/it]08/28/2023 22:51:46 - INFO - __main__ -   Step: 401, LR: 1.6563921172309246e-05, Loss: 0.578311026096344
[2023-08-28 22:52:01,555] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 402/2040 [29:09<13:08:28, 28.88s/it]08/28/2023 22:52:01 - INFO - __main__ -   Step: 402, LR: 1.655381505811016e-05, Loss: 0.5877479314804077
[2023-08-28 22:52:18,268] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 403/2040 [29:25<11:28:23, 25.23s/it]08/28/2023 22:52:18 - INFO - __main__ -   Step: 403, LR: 1.6543708943911067e-05, Loss: 0.5829876661300659
[2023-08-28 22:52:33,184] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 404/2040 [29:40<10:03:35, 22.14s/it]08/28/2023 22:52:33 - INFO - __main__ -   Step: 404, LR: 1.6533602829711976e-05, Loss: 0.5829089879989624
[2023-08-28 22:52:49,816] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 405/2040 [29:57<9:18:13, 20.49s/it] 08/28/2023 22:52:49 - INFO - __main__ -   Step: 405, LR: 1.6523496715512886e-05, Loss: 0.47907572984695435
[2023-08-28 22:53:05,275] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 406/2040 [30:12<8:36:49, 18.98s/it]08/28/2023 22:53:05 - INFO - __main__ -   Step: 406, LR: 1.6513390601313798e-05, Loss: 0.5111969709396362
[2023-08-28 22:53:22,056] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|█▉        | 407/2040 [30:29<8:18:34, 18.32s/it]08/28/2023 22:53:22 - INFO - __main__ -   Step: 407, LR: 1.6503284487114707e-05, Loss: 0.5893272161483765
[2023-08-28 22:53:37,196] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 408/2040 [30:44<7:52:19, 17.36s/it]08/28/2023 22:53:37 - INFO - __main__ -   Step: 408, LR: 1.6493178372915616e-05, Loss: 0.5653152465820312
[2023-08-28 22:53:53,042] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 409/2040 [31:00<7:39:39, 16.91s/it]08/28/2023 22:53:53 - INFO - __main__ -   Step: 409, LR: 1.6483072258716525e-05, Loss: 0.5587713718414307
[2023-08-28 22:54:08,344] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 410/2040 [31:15<7:26:16, 16.43s/it]08/28/2023 22:54:08 - INFO - __main__ -   Step: 410, LR: 1.6472966144517434e-05, Loss: 0.5340232253074646
[2023-08-28 22:54:24,438] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 411/2040 [31:32<7:23:17, 16.33s/it]08/28/2023 22:54:24 - INFO - __main__ -   Step: 411, LR: 1.6462860030318343e-05, Loss: 0.612034797668457
[2023-08-28 22:54:43,026] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 412/2040 [31:50<7:41:24, 17.01s/it]08/28/2023 22:54:43 - INFO - __main__ -   Step: 412, LR: 1.6452753916119252e-05, Loss: 0.5318015217781067
[2023-08-28 22:55:00,565] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 413/2040 [32:08<7:45:28, 17.17s/it]08/28/2023 22:55:00 - INFO - __main__ -   Step: 413, LR: 1.6442647801920165e-05, Loss: 0.5606005191802979
[2023-08-28 22:55:17,077] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 414/2040 [32:24<7:39:52, 16.97s/it]08/28/2023 22:55:17 - INFO - __main__ -   Step: 414, LR: 1.6432541687721074e-05, Loss: 0.5290375351905823
[2023-08-28 22:55:32,723] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 415/2040 [32:40<7:28:50, 16.57s/it]08/28/2023 22:55:32 - INFO - __main__ -   Step: 415, LR: 1.6422435573521983e-05, Loss: 0.6215568780899048
[2023-08-28 22:55:49,674] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 416/2040 [32:57<7:31:37, 16.69s/it]08/28/2023 22:55:49 - INFO - __main__ -   Step: 416, LR: 1.6412329459322892e-05, Loss: 0.5574697852134705
[2023-08-28 22:56:07,160] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 417/2040 [33:14<7:37:50, 16.93s/it]08/28/2023 22:56:07 - INFO - __main__ -   Step: 417, LR: 1.64022233451238e-05, Loss: 0.49381759762763977
[2023-08-28 22:56:26,165] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 20%|██        | 418/2040 [33:33<7:54:25, 17.55s/it]08/28/2023 22:56:26 - INFO - __main__ -   Step: 418, LR: 1.639211723092471e-05, Loss: 0.5816042423248291
[2023-08-28 22:56:44,466] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 419/2040 [33:52<8:00:13, 17.78s/it]08/28/2023 22:56:44 - INFO - __main__ -   Step: 419, LR: 1.638201111672562e-05, Loss: 0.540290117263794
[2023-08-28 22:57:00,337] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 420/2040 [34:07<7:44:30, 17.20s/it]08/28/2023 22:57:00 - INFO - __main__ -   Step: 420, LR: 1.637190500252653e-05, Loss: 0.5169390439987183
[2023-08-28 22:57:14,345] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 421/2040 [34:21<7:18:20, 16.25s/it]08/28/2023 22:57:14 - INFO - __main__ -   Step: 421, LR: 1.636179888832744e-05, Loss: 0.5917709469795227
[2023-08-28 22:57:29,609] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 422/2040 [34:37<7:10:08, 15.95s/it]08/28/2023 22:57:29 - INFO - __main__ -   Step: 422, LR: 1.635169277412835e-05, Loss: 0.5397762656211853
[2023-08-28 22:57:43,527] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 423/2040 [34:51<6:53:26, 15.34s/it]08/28/2023 22:57:43 - INFO - __main__ -   Step: 423, LR: 1.634158665992926e-05, Loss: 0.5505275726318359
[2023-08-28 22:58:00,074] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 424/2040 [35:07<7:02:55, 15.70s/it]08/28/2023 22:58:00 - INFO - __main__ -   Step: 424, LR: 1.6331480545730168e-05, Loss: 0.653644859790802
[2023-08-28 22:58:14,690] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 425/2040 [35:22<6:53:53, 15.38s/it]08/28/2023 22:58:14 - INFO - __main__ -   Step: 425, LR: 1.6321374431531077e-05, Loss: 0.6130650043487549
[2023-08-28 22:58:32,464] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 426/2040 [35:40<7:12:58, 16.10s/it]08/28/2023 22:58:32 - INFO - __main__ -   Step: 426, LR: 1.6311268317331986e-05, Loss: 0.5372962951660156
[2023-08-28 22:58:50,033] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 427/2040 [35:57<7:24:35, 16.54s/it]08/28/2023 22:58:50 - INFO - __main__ -   Step: 427, LR: 1.6301162203132895e-05, Loss: 0.5271650552749634
[2023-08-28 22:59:06,623] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 428/2040 [36:14<7:24:44, 16.55s/it]08/28/2023 22:59:06 - INFO - __main__ -   Step: 428, LR: 1.6291056088933804e-05, Loss: 0.5549405217170715
[2023-08-28 22:59:23,387] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 429/2040 [36:31<7:26:09, 16.62s/it]08/28/2023 22:59:23 - INFO - __main__ -   Step: 429, LR: 1.6280949974734717e-05, Loss: 0.5710076093673706
[2023-08-28 22:59:40,002] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 430/2040 [36:47<7:25:51, 16.62s/it]08/28/2023 22:59:40 - INFO - __main__ -   Step: 430, LR: 1.6270843860535626e-05, Loss: 0.6564048528671265
[2023-08-28 22:59:56,200] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 431/2040 [37:03<7:22:13, 16.49s/it]08/28/2023 22:59:56 - INFO - __main__ -   Step: 431, LR: 1.6260737746336535e-05, Loss: 0.5279701948165894
[2023-08-28 23:00:10,539] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 432/2040 [37:18<7:04:39, 15.85s/it]08/28/2023 23:00:10 - INFO - __main__ -   Step: 432, LR: 1.6250631632137444e-05, Loss: 0.662376880645752
[2023-08-28 23:00:28,646] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██        | 433/2040 [37:36<7:22:33, 16.52s/it]08/28/2023 23:00:28 - INFO - __main__ -   Step: 433, LR: 1.6240525517938353e-05, Loss: 0.6021232008934021
[2023-08-28 23:00:45,001] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██▏       | 434/2040 [37:52<7:20:55, 16.47s/it]08/28/2023 23:00:45 - INFO - __main__ -   Step: 434, LR: 1.6230419403739262e-05, Loss: 0.5615093111991882
[2023-08-28 23:01:02,078] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██▏       | 435/2040 [38:09<7:25:30, 16.65s/it]08/28/2023 23:01:02 - INFO - __main__ -   Step: 435, LR: 1.622031328954017e-05, Loss: 0.5177292823791504
[2023-08-28 23:01:16,486] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██▏       | 436/2040 [38:24<7:07:12, 15.98s/it]08/28/2023 23:01:16 - INFO - __main__ -   Step: 436, LR: 1.621020717534108e-05, Loss: 0.6232507228851318
[2023-08-28 23:01:34,226] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██▏       | 437/2040 [38:41<7:21:03, 16.51s/it]08/28/2023 23:01:34 - INFO - __main__ -   Step: 437, LR: 1.6200101061141993e-05, Loss: 0.5623160600662231
[2023-08-28 23:01:48,822] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 21%|██▏       | 438/2040 [38:56<7:05:27, 15.93s/it]08/28/2023 23:01:48 - INFO - __main__ -   Step: 438, LR: 1.6189994946942902e-05, Loss: 0.4776402711868286
[2023-08-28 23:02:05,155] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 439/2040 [39:12<7:08:22, 16.05s/it]08/28/2023 23:02:05 - INFO - __main__ -   Step: 439, LR: 1.617988883274381e-05, Loss: 0.5979331731796265
[2023-08-28 23:02:20,691] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 440/2040 [39:28<7:03:57, 15.90s/it]08/28/2023 23:02:20 - INFO - __main__ -   Step: 440, LR: 1.616978271854472e-05, Loss: 0.5322308540344238
[2023-08-28 23:02:37,212] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 441/2040 [39:44<7:08:40, 16.09s/it]08/28/2023 23:02:37 - INFO - __main__ -   Step: 441, LR: 1.6159676604345633e-05, Loss: 0.5482803583145142
[2023-08-28 23:02:53,511] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 442/2040 [40:01<7:10:06, 16.15s/it]08/28/2023 23:02:53 - INFO - __main__ -   Step: 442, LR: 1.614957049014654e-05, Loss: 0.5776748657226562
[2023-08-28 23:03:07,651] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 443/2040 [40:15<6:53:47, 15.55s/it]08/28/2023 23:03:07 - INFO - __main__ -   Step: 443, LR: 1.6139464375947447e-05, Loss: 0.48913997411727905
[2023-08-28 23:03:22,476] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 444/2040 [40:30<6:47:46, 15.33s/it]08/28/2023 23:03:22 - INFO - __main__ -   Step: 444, LR: 1.612935826174836e-05, Loss: 0.5349948406219482
[2023-08-28 23:03:38,615] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 445/2040 [40:46<6:53:58, 15.57s/it]08/28/2023 23:03:38 - INFO - __main__ -   Step: 445, LR: 1.611925214754927e-05, Loss: 0.5537970066070557
[2023-08-28 23:03:53,464] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 446/2040 [41:01<6:47:56, 15.36s/it]08/28/2023 23:03:53 - INFO - __main__ -   Step: 446, LR: 1.6109146033350178e-05, Loss: 0.6479376554489136
[2023-08-28 23:04:08,790] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 447/2040 [41:16<6:47:27, 15.35s/it]08/28/2023 23:04:08 - INFO - __main__ -   Step: 447, LR: 1.6099039919151087e-05, Loss: 0.5509052276611328
[2023-08-28 23:04:23,085] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 448/2040 [41:30<6:38:49, 15.03s/it]08/28/2023 23:04:23 - INFO - __main__ -   Step: 448, LR: 1.6088933804952e-05, Loss: 0.5438730716705322
[2023-08-28 23:04:39,148] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 449/2040 [41:46<6:46:46, 15.34s/it]08/28/2023 23:04:39 - INFO - __main__ -   Step: 449, LR: 1.607882769075291e-05, Loss: 0.5172418355941772
[2023-08-28 23:04:53,809] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 450/2040 [42:01<6:41:07, 15.14s/it]08/28/2023 23:04:53 - INFO - __main__ -   Step: 450, LR: 1.6068721576553818e-05, Loss: 0.5541830658912659
[2023-08-28 23:05:08,864] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 451/2040 [42:16<6:40:13, 15.11s/it]08/28/2023 23:05:08 - INFO - __main__ -   Step: 451, LR: 1.6058615462354727e-05, Loss: 0.4561713933944702
[2023-08-28 23:05:23,478] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 452/2040 [42:31<6:36:01, 14.96s/it]08/28/2023 23:05:23 - INFO - __main__ -   Step: 452, LR: 1.6048509348155636e-05, Loss: 0.5443345904350281
[2023-08-28 23:05:39,087] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 453/2040 [42:46<6:40:53, 15.16s/it]08/28/2023 23:05:39 - INFO - __main__ -   Step: 453, LR: 1.6038403233956545e-05, Loss: 0.596123993396759
[2023-08-28 23:05:55,953] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 454/2040 [43:03<6:54:11, 15.67s/it]08/28/2023 23:05:55 - INFO - __main__ -   Step: 454, LR: 1.6028297119757454e-05, Loss: 0.5337054133415222
[2023-08-28 23:06:10,854] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 455/2040 [43:18<6:47:50, 15.44s/it]08/28/2023 23:06:10 - INFO - __main__ -   Step: 455, LR: 1.6018191005558363e-05, Loss: 0.544580340385437
[2023-08-28 23:06:32,146] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 456/2040 [43:39<7:33:56, 17.19s/it]08/28/2023 23:06:32 - INFO - __main__ -   Step: 456, LR: 1.6008084891359275e-05, Loss: 0.5897070169448853
[2023-08-28 23:06:48,942] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 457/2040 [43:56<7:30:29, 17.08s/it]08/28/2023 23:06:48 - INFO - __main__ -   Step: 457, LR: 1.5997978777160184e-05, Loss: 0.5539447069168091
[2023-08-28 23:07:03,030] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▏       | 458/2040 [44:10<7:06:35, 16.18s/it]08/28/2023 23:07:03 - INFO - __main__ -   Step: 458, LR: 1.5987872662961094e-05, Loss: 0.5525811910629272
[2023-08-28 23:07:20,174] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 22%|██▎       | 459/2040 [44:27<7:13:56, 16.47s/it]08/28/2023 23:07:20 - INFO - __main__ -   Step: 459, LR: 1.5977766548762003e-05, Loss: 0.6111918687820435
[2023-08-28 23:07:36,243] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 460/2040 [44:43<7:10:30, 16.35s/it]08/28/2023 23:07:36 - INFO - __main__ -   Step: 460, LR: 1.5967660434562912e-05, Loss: 0.6214245557785034
[2023-08-28 23:07:53,786] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 461/2040 [45:01<7:19:40, 16.71s/it]08/28/2023 23:07:53 - INFO - __main__ -   Step: 461, LR: 1.595755432036382e-05, Loss: 0.5713928937911987
[2023-08-28 23:08:08,378] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 462/2040 [45:16<7:02:42, 16.07s/it]08/28/2023 23:08:08 - INFO - __main__ -   Step: 462, LR: 1.594744820616473e-05, Loss: 0.5443079471588135
[2023-08-28 23:08:26,681] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 463/2040 [45:34<7:20:01, 16.74s/it]08/28/2023 23:08:26 - INFO - __main__ -   Step: 463, LR: 1.593734209196564e-05, Loss: 0.5284688472747803
[2023-08-28 23:08:40,893] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 464/2040 [45:48<6:59:48, 15.98s/it]08/28/2023 23:08:40 - INFO - __main__ -   Step: 464, LR: 1.592723597776655e-05, Loss: 0.5367606282234192
[2023-08-28 23:08:58,958] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 465/2040 [46:06<7:15:56, 16.61s/it]08/28/2023 23:08:58 - INFO - __main__ -   Step: 465, LR: 1.591712986356746e-05, Loss: 0.5205137133598328
[2023-08-28 23:09:16,699] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 466/2040 [46:24<7:24:35, 16.95s/it]08/28/2023 23:09:16 - INFO - __main__ -   Step: 466, LR: 1.590702374936837e-05, Loss: 0.5176394581794739
[2023-08-28 23:09:33,516] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 467/2040 [46:41<7:23:16, 16.91s/it]08/28/2023 23:09:33 - INFO - __main__ -   Step: 467, LR: 1.589691763516928e-05, Loss: 0.572601318359375
[2023-08-28 23:09:51,246] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 468/2040 [46:58<7:29:27, 17.15s/it]08/28/2023 23:09:51 - INFO - __main__ -   Step: 468, LR: 1.5886811520970188e-05, Loss: 0.5601555109024048
[2023-08-28 23:10:07,677] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 469/2040 [47:15<7:23:28, 16.94s/it]08/28/2023 23:10:07 - INFO - __main__ -   Step: 469, LR: 1.5876705406771097e-05, Loss: 0.5641825199127197
[2023-08-28 23:10:22,205] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 470/2040 [47:29<7:04:17, 16.21s/it]08/28/2023 23:10:22 - INFO - __main__ -   Step: 470, LR: 1.5866599292572006e-05, Loss: 0.541895866394043
[2023-08-28 23:10:40,409] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 471/2040 [47:48<7:19:37, 16.81s/it]08/28/2023 23:10:40 - INFO - __main__ -   Step: 471, LR: 1.5856493178372915e-05, Loss: 0.5788068771362305
[2023-08-28 23:10:58,387] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 472/2040 [48:06<7:28:29, 17.16s/it]08/28/2023 23:10:58 - INFO - __main__ -   Step: 472, LR: 1.5846387064173827e-05, Loss: 0.5364594459533691
[2023-08-28 23:11:15,960] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 473/2040 [48:23<7:31:25, 17.28s/it]08/28/2023 23:11:15 - INFO - __main__ -   Step: 473, LR: 1.5836280949974736e-05, Loss: 0.5433058738708496
[2023-08-28 23:11:35,246] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 474/2040 [48:42<7:46:48, 17.89s/it]08/28/2023 23:11:35 - INFO - __main__ -   Step: 474, LR: 1.5826174835775646e-05, Loss: 0.528528094291687
[2023-08-28 23:11:52,993] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 475/2040 [49:00<7:45:25, 17.84s/it]08/28/2023 23:11:52 - INFO - __main__ -   Step: 475, LR: 1.5816068721576555e-05, Loss: 0.5062530636787415
[2023-08-28 23:12:09,588] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 476/2040 [49:17<7:35:21, 17.47s/it]08/28/2023 23:12:09 - INFO - __main__ -   Step: 476, LR: 1.5805962607377464e-05, Loss: 0.5698278546333313
[2023-08-28 23:12:26,826] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 477/2040 [49:34<7:33:15, 17.40s/it]08/28/2023 23:12:26 - INFO - __main__ -   Step: 477, LR: 1.5795856493178373e-05, Loss: 0.5454461574554443
[2023-08-28 23:12:42,426] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 478/2040 [49:50<7:18:55, 16.86s/it]08/28/2023 23:12:42 - INFO - __main__ -   Step: 478, LR: 1.5785750378979282e-05, Loss: 0.5717653632164001
[2023-08-28 23:12:58,352] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 23%|██▎       | 479/2040 [50:05<7:11:20, 16.58s/it]08/28/2023 23:12:58 - INFO - __main__ -   Step: 479, LR: 1.5775644264780194e-05, Loss: 0.5677725672721863
[2023-08-28 23:13:13,265] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▎       | 480/2040 [50:20<6:58:04, 16.08s/it]08/28/2023 23:13:13 - INFO - __main__ -   Step: 480, LR: 1.5765538150581103e-05, Loss: 0.5485190749168396
[2023-08-28 23:13:29,433] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▎       | 481/2040 [50:37<6:58:29, 16.11s/it]08/28/2023 23:13:29 - INFO - __main__ -   Step: 481, LR: 1.5755432036382012e-05, Loss: 0.5774106383323669
[2023-08-28 23:13:47,311] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▎       | 482/2040 [50:54<7:12:01, 16.64s/it]08/28/2023 23:13:47 - INFO - __main__ -   Step: 482, LR: 1.574532592218292e-05, Loss: 0.49386537075042725
[2023-08-28 23:14:04,184] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▎       | 483/2040 [51:11<7:13:35, 16.71s/it]08/28/2023 23:14:04 - INFO - __main__ -   Step: 483, LR: 1.5735219807983834e-05, Loss: 0.5608648061752319
[2023-08-28 23:14:20,961] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▎       | 484/2040 [51:28<7:13:50, 16.73s/it]08/28/2023 23:14:20 - INFO - __main__ -   Step: 484, LR: 1.5725113693784743e-05, Loss: 0.5919024348258972
[2023-08-28 23:14:35,792] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 485/2040 [51:43<6:58:47, 16.16s/it]08/28/2023 23:14:35 - INFO - __main__ -   Step: 485, LR: 1.5715007579585652e-05, Loss: 0.5405636429786682
[2023-08-28 23:14:52,766] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 486/2040 [52:00<7:04:51, 16.40s/it]08/28/2023 23:14:52 - INFO - __main__ -   Step: 486, LR: 1.5704901465386558e-05, Loss: 0.5140451192855835
[2023-08-28 23:15:09,889] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 487/2040 [52:17<7:10:10, 16.62s/it]08/28/2023 23:15:09 - INFO - __main__ -   Step: 487, LR: 1.569479535118747e-05, Loss: 0.5725513696670532
[2023-08-28 23:15:26,635] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 488/2040 [52:34<7:10:52, 16.66s/it]08/28/2023 23:15:26 - INFO - __main__ -   Step: 488, LR: 1.568468923698838e-05, Loss: 0.5506278276443481
[2023-08-28 23:15:42,924] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 489/2040 [52:50<7:07:44, 16.55s/it]08/28/2023 23:15:42 - INFO - __main__ -   Step: 489, LR: 1.567458312278929e-05, Loss: 0.5958453416824341
[2023-08-28 23:15:58,274] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 490/2040 [53:05<6:58:11, 16.19s/it]08/28/2023 23:15:58 - INFO - __main__ -   Step: 490, LR: 1.5664477008590197e-05, Loss: 0.557418704032898
[2023-08-28 23:16:12,318] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 491/2040 [53:19<6:41:18, 15.54s/it]08/28/2023 23:16:12 - INFO - __main__ -   Step: 491, LR: 1.565437089439111e-05, Loss: 0.6173372864723206
[2023-08-28 23:16:27,408] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 492/2040 [53:35<6:37:31, 15.41s/it]08/28/2023 23:16:27 - INFO - __main__ -   Step: 492, LR: 1.564426478019202e-05, Loss: 0.5568881034851074
[2023-08-28 23:16:44,597] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 493/2040 [53:52<6:51:03, 15.94s/it]08/28/2023 23:16:44 - INFO - __main__ -   Step: 493, LR: 1.5634158665992928e-05, Loss: 0.5669848918914795
[2023-08-28 23:17:03,381] [WARNING] [stage3.py:1898:step] 4 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 494/2040 [54:11<7:12:44, 16.79s/it]08/28/2023 23:17:03 - INFO - __main__ -   Step: 494, LR: 1.5624052551793837e-05, Loss: 0.6054717302322388
[2023-08-28 23:17:18,030] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 495/2040 [54:25<6:55:53, 16.15s/it]08/28/2023 23:17:18 - INFO - __main__ -   Step: 495, LR: 1.5613946437594746e-05, Loss: 0.5790857076644897
[2023-08-28 23:17:34,303] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 496/2040 [54:41<6:56:33, 16.19s/it]08/28/2023 23:17:34 - INFO - __main__ -   Step: 496, LR: 1.5603840323395655e-05, Loss: 0.5922335386276245
[2023-08-28 23:17:51,349] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 497/2040 [54:58<7:02:54, 16.45s/it]08/28/2023 23:17:51 - INFO - __main__ -   Step: 497, LR: 1.5593734209196564e-05, Loss: 0.6120217442512512
[2023-08-28 23:18:08,179] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 498/2040 [55:15<7:05:36, 16.56s/it]08/28/2023 23:18:08 - INFO - __main__ -   Step: 498, LR: 1.5583628094997473e-05, Loss: 0.5490145087242126
[2023-08-28 23:18:25,559] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 24%|██▍       | 499/2040 [55:33<7:11:38, 16.81s/it]08/28/2023 23:18:25 - INFO - __main__ -   Step: 499, LR: 1.5573521980798386e-05, Loss: 0.5835879445075989
[2023-08-28 23:18:40,090] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 500/2040 [55:47<6:53:50, 16.12s/it]08/28/2023 23:18:40 - INFO - __main__ -   Step: 500, LR: 1.5563415866599295e-05, Loss: 0.5137971043586731
08/28/2023 23:18:40 - INFO - accelerate.accelerator - Saving current state to /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500
08/28/2023 23:18:40 - INFO - accelerate.accelerator - Saving DeepSpeed Model and Optimizer
[2023-08-28 23:18:40,099] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint pytorch_model is about to be saved!
[2023-08-28 23:18:40,105] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt
[2023-08-28 23:18:40,106] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt...
[2023-08-28 23:18:40,106] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt...
[2023-08-28 23:18:40,107] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt
[2023-08-28 23:18:40,107] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2023-08-28 23:18:40,108] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt...
[2023-08-28 23:18:40,120] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt.
[2023-08-28 23:18:40,120] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt.
[2023-08-28 23:18:40,121] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2023-08-28 23:18:40,132] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt.
[2023-08-28 23:18:40,132] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2023-08-28 23:18:40,132] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt...
[2023-08-28 23:18:40,132] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt...
[2023-08-28 23:18:40,132] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt...
[2023-08-28 23:19:33,701] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt.
[2023-08-28 23:19:33,701] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt
[2023-08-28 23:19:36,752] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2023-08-28 23:19:36,753] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2023-08-28 23:19:40,468] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt.
[2023-08-28 23:19:40,468] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt
[2023-08-28 23:19:41,230] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt.
[2023-08-28 23:19:41,230] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt
[2023-08-28 23:19:41,235] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 23:19:41,235] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 23:19:41,235] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 23:19:41,235] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
08/28/2023 23:19:41 - INFO - accelerate.accelerator - DeepSpeed Model and Optimizer saved to output dir /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/pytorch_model
08/28/2023 23:19:41 - INFO - accelerate.checkpointing - Scheduler state saved in /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/scheduler.bin
08/28/2023 23:19:41 - INFO - accelerate.checkpointing - Random states saved in /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_500/random_states_0.pkl
[2023-08-28 23:19:55,018] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 501/2040 [57:02<14:26:04, 33.77s/it]08/28/2023 23:19:55 - INFO - __main__ -   Step: 501, LR: 1.5553309752400204e-05, Loss: 0.5825262069702148
[2023-08-28 23:20:12,902] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 502/2040 [57:20<12:23:23, 29.00s/it]08/28/2023 23:20:12 - INFO - __main__ -   Step: 502, LR: 1.5543203638201113e-05, Loss: 0.6097316145896912
[2023-08-28 23:20:27,330] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 503/2040 [57:34<10:30:54, 24.63s/it]08/28/2023 23:20:27 - INFO - __main__ -   Step: 503, LR: 1.5533097524002022e-05, Loss: 0.5629314184188843
[2023-08-28 23:20:44,442] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 504/2040 [57:52<9:32:46, 22.37s/it] 08/28/2023 23:20:44 - INFO - __main__ -   Step: 504, LR: 1.552299140980293e-05, Loss: 0.5760045051574707
[2023-08-28 23:20:58,960] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 505/2040 [58:06<8:32:06, 20.02s/it]08/28/2023 23:20:58 - INFO - __main__ -   Step: 505, LR: 1.551288529560384e-05, Loss: 0.5651344656944275
[2023-08-28 23:21:15,473] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 506/2040 [58:23<8:04:53, 18.97s/it]08/28/2023 23:21:15 - INFO - __main__ -   Step: 506, LR: 1.550277918140475e-05, Loss: 0.5316535234451294
[2023-08-28 23:21:33,458] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 507/2040 [58:41<7:57:03, 18.67s/it]08/28/2023 23:21:33 - INFO - __main__ -   Step: 507, LR: 1.5492673067205662e-05, Loss: 0.5739575624465942
[2023-08-28 23:21:50,343] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 508/2040 [58:57<7:43:03, 18.14s/it]08/28/2023 23:21:50 - INFO - __main__ -   Step: 508, LR: 1.548256695300657e-05, Loss: 0.5422476530075073
[2023-08-28 23:22:07,872] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▍       | 509/2040 [59:15<7:38:06, 17.95s/it]08/28/2023 23:22:07 - INFO - __main__ -   Step: 509, LR: 1.547246083880748e-05, Loss: 0.5741925239562988
[2023-08-28 23:22:25,825] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 510/2040 [59:33<7:37:48, 17.95s/it]08/28/2023 23:22:25 - INFO - __main__ -   Step: 510, LR: 1.546235472460839e-05, Loss: 0.6352577209472656
[2023-08-28 23:22:41,828] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 511/2040 [59:49<7:22:35, 17.37s/it]08/28/2023 23:22:41 - INFO - __main__ -   Step: 511, LR: 1.5452248610409298e-05, Loss: 0.4987068176269531
[2023-08-28 23:22:56,437] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 512/2040 [1:00:04<7:01:13, 16.54s/it]08/28/2023 23:22:56 - INFO - __main__ -   Step: 512, LR: 1.5442142496210207e-05, Loss: 0.5271708965301514
[2023-08-28 23:23:13,532] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 513/2040 [1:00:21<7:05:11, 16.71s/it]08/28/2023 23:23:13 - INFO - __main__ -   Step: 513, LR: 1.5432036382011116e-05, Loss: 0.5009812116622925
[2023-08-28 23:23:29,894] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 514/2040 [1:00:37<7:02:16, 16.60s/it]08/28/2023 23:23:29 - INFO - __main__ -   Step: 514, LR: 1.542193026781203e-05, Loss: 0.5712625980377197
[2023-08-28 23:23:46,238] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 515/2040 [1:00:53<7:00:01, 16.53s/it]08/28/2023 23:23:46 - INFO - __main__ -   Step: 515, LR: 1.5411824153612938e-05, Loss: 0.5683187246322632
[2023-08-28 23:24:03,332] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 516/2040 [1:01:10<7:04:04, 16.70s/it]08/28/2023 23:24:03 - INFO - __main__ -   Step: 516, LR: 1.5401718039413847e-05, Loss: 0.5324313640594482
[2023-08-28 23:24:23,356] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 517/2040 [1:01:30<7:29:08, 17.69s/it]08/28/2023 23:24:23 - INFO - __main__ -   Step: 517, LR: 1.5391611925214756e-05, Loss: 0.5612896084785461
[2023-08-28 23:24:42,066] [WARNING] [stage3.py:1898:step] 5 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 518/2040 [1:01:49<7:36:34, 18.00s/it]08/28/2023 23:24:42 - INFO - __main__ -   Step: 518, LR: 1.5381505811015665e-05, Loss: 0.5979434251785278
[2023-08-28 23:24:56,803] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 519/2040 [1:02:04<7:11:28, 17.02s/it]08/28/2023 23:24:56 - INFO - __main__ -   Step: 519, LR: 1.5371399696816574e-05, Loss: 0.5026485919952393
[2023-08-28 23:25:13,371] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 25%|██▌       | 520/2040 [1:02:21<7:07:44, 16.88s/it]08/28/2023 23:25:13 - INFO - __main__ -   Step: 520, LR: 1.5361293582617483e-05, Loss: 0.5538932681083679
[2023-08-28 23:25:30,158] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 521/2040 [1:02:37<7:06:43, 16.86s/it]08/28/2023 23:25:30 - INFO - __main__ -   Step: 521, LR: 1.5351187468418392e-05, Loss: 0.6141395568847656
[2023-08-28 23:25:46,926] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 522/2040 [1:02:54<7:05:46, 16.83s/it]08/28/2023 23:25:46 - INFO - __main__ -   Step: 522, LR: 1.5341081354219305e-05, Loss: 0.4655282497406006
[2023-08-28 23:26:03,271] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 523/2040 [1:03:10<7:01:49, 16.68s/it]08/28/2023 23:26:03 - INFO - __main__ -   Step: 523, LR: 1.5330975240020214e-05, Loss: 0.5550060272216797
[2023-08-28 23:26:20,543] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 524/2040 [1:03:28<7:06:00, 16.86s/it]08/28/2023 23:26:20 - INFO - __main__ -   Step: 524, LR: 1.5320869125821123e-05, Loss: 0.6065593957901001
[2023-08-28 23:26:40,147] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 525/2040 [1:03:47<7:26:30, 17.68s/it]08/28/2023 23:26:40 - INFO - __main__ -   Step: 525, LR: 1.5310763011622032e-05, Loss: 0.5464333891868591
[2023-08-28 23:27:02,447] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 526/2040 [1:04:10<8:01:09, 19.07s/it]08/28/2023 23:27:02 - INFO - __main__ -   Step: 526, LR: 1.5300656897422944e-05, Loss: 0.5317344665527344
[2023-08-28 23:27:21,264] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 527/2040 [1:04:28<7:58:56, 18.99s/it]08/28/2023 23:27:21 - INFO - __main__ -   Step: 527, LR: 1.5290550783223854e-05, Loss: 0.5429956912994385
[2023-08-28 23:27:36,956] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 528/2040 [1:04:44<7:33:40, 18.00s/it]08/28/2023 23:27:36 - INFO - __main__ -   Step: 528, LR: 1.5280444669024763e-05, Loss: 0.5654146075248718
[2023-08-28 23:27:52,781] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 529/2040 [1:05:00<7:16:54, 17.35s/it]08/28/2023 23:27:52 - INFO - __main__ -   Step: 529, LR: 1.5270338554825668e-05, Loss: 0.5724762082099915
[2023-08-28 23:28:07,938] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 530/2040 [1:05:15<7:00:04, 16.69s/it]08/28/2023 23:28:07 - INFO - __main__ -   Step: 530, LR: 1.526023244062658e-05, Loss: 0.5293650031089783
[2023-08-28 23:28:22,271] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 531/2040 [1:05:29<6:41:59, 15.98s/it]08/28/2023 23:28:22 - INFO - __main__ -   Step: 531, LR: 1.525012632642749e-05, Loss: 0.6151336431503296
[2023-08-28 23:28:39,581] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 532/2040 [1:05:47<6:51:43, 16.38s/it]08/28/2023 23:28:39 - INFO - __main__ -   Step: 532, LR: 1.5240020212228399e-05, Loss: 0.5336352586746216
[2023-08-28 23:28:55,877] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 533/2040 [1:06:03<6:50:48, 16.36s/it]08/28/2023 23:28:55 - INFO - __main__ -   Step: 533, LR: 1.5229914098029308e-05, Loss: 0.5483694672584534
[2023-08-28 23:29:12,597] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 534/2040 [1:06:20<6:53:16, 16.47s/it]08/28/2023 23:29:12 - INFO - __main__ -   Step: 534, LR: 1.5219807983830219e-05, Loss: 0.5553860664367676
[2023-08-28 23:29:33,255] [WARNING] [stage3.py:1898:step] 4 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▌       | 535/2040 [1:06:40<7:24:33, 17.72s/it]08/28/2023 23:29:33 - INFO - __main__ -   Step: 535, LR: 1.5209701869631128e-05, Loss: 0.5360859632492065
[2023-08-28 23:29:50,868] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▋       | 536/2040 [1:06:58<7:23:25, 17.69s/it]08/28/2023 23:29:50 - INFO - __main__ -   Step: 536, LR: 1.5199595755432037e-05, Loss: 0.5329172015190125
[2023-08-28 23:30:07,104] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▋       | 537/2040 [1:07:14<7:12:12, 17.25s/it]08/28/2023 23:30:07 - INFO - __main__ -   Step: 537, LR: 1.5189489641232946e-05, Loss: 0.6666858196258545
[2023-08-28 23:30:26,314] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▋       | 538/2040 [1:07:33<7:26:36, 17.84s/it]08/28/2023 23:30:26 - INFO - __main__ -   Step: 538, LR: 1.5179383527033857e-05, Loss: 0.6143792867660522
[2023-08-28 23:30:40,006] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▋       | 539/2040 [1:07:47<6:55:10, 16.60s/it]08/28/2023 23:30:40 - INFO - __main__ -   Step: 539, LR: 1.5169277412834766e-05, Loss: 0.5969198942184448
[2023-08-28 23:30:57,797] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 26%|██▋       | 540/2040 [1:08:05<7:03:51, 16.95s/it]08/28/2023 23:30:57 - INFO - __main__ -   Step: 540, LR: 1.5159171298635675e-05, Loss: 0.483215868473053
[2023-08-28 23:31:13,455] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 541/2040 [1:08:21<6:53:51, 16.57s/it]08/28/2023 23:31:13 - INFO - __main__ -   Step: 541, LR: 1.5149065184436584e-05, Loss: 0.5641422867774963
[2023-08-28 23:31:28,415] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 542/2040 [1:08:36<6:41:33, 16.08s/it]08/28/2023 23:31:28 - INFO - __main__ -   Step: 542, LR: 1.5138959070237496e-05, Loss: 0.6048259139060974
[2023-08-28 23:31:42,874] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 543/2040 [1:08:50<6:29:07, 15.60s/it]08/28/2023 23:31:42 - INFO - __main__ -   Step: 543, LR: 1.5128852956038404e-05, Loss: 0.5354406237602234
[2023-08-28 23:31:58,366] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 544/2040 [1:09:06<6:28:05, 15.57s/it]08/28/2023 23:31:58 - INFO - __main__ -   Step: 544, LR: 1.5118746841839313e-05, Loss: 0.6493837237358093
[2023-08-28 23:32:15,675] [WARNING] [stage3.py:1898:step] 4 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 545/2040 [1:09:23<6:40:51, 16.09s/it]08/28/2023 23:32:15 - INFO - __main__ -   Step: 545, LR: 1.5108640727640222e-05, Loss: 0.5418750047683716
[2023-08-28 23:32:30,049] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 546/2040 [1:09:37<6:27:47, 15.57s/it]08/28/2023 23:32:30 - INFO - __main__ -   Step: 546, LR: 1.5098534613441134e-05, Loss: 0.6607030630111694
[2023-08-28 23:32:44,718] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 547/2040 [1:09:52<6:20:46, 15.30s/it]08/28/2023 23:32:44 - INFO - __main__ -   Step: 547, LR: 1.5088428499242043e-05, Loss: 0.6985912322998047
[2023-08-28 23:32:59,433] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 548/2040 [1:10:07<6:16:08, 15.13s/it]08/28/2023 23:32:59 - INFO - __main__ -   Step: 548, LR: 1.507832238504295e-05, Loss: 0.6276907920837402
[2023-08-28 23:33:15,689] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 549/2040 [1:10:23<6:24:18, 15.47s/it]08/28/2023 23:33:15 - INFO - __main__ -   Step: 549, LR: 1.5068216270843863e-05, Loss: 0.5936489701271057
[2023-08-28 23:33:29,805] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 550/2040 [1:10:37<6:14:00, 15.06s/it]08/28/2023 23:33:29 - INFO - __main__ -   Step: 550, LR: 1.5058110156644772e-05, Loss: 0.6385349035263062
[2023-08-28 23:33:44,056] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 551/2040 [1:10:51<6:07:43, 14.82s/it]08/28/2023 23:33:44 - INFO - __main__ -   Step: 551, LR: 1.5048004042445681e-05, Loss: 0.5503010749816895
[2023-08-28 23:34:05,171] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 552/2040 [1:11:12<6:54:19, 16.71s/it]08/28/2023 23:34:05 - INFO - __main__ -   Step: 552, LR: 1.503789792824659e-05, Loss: 0.5722304582595825
[2023-08-28 23:34:19,780] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 553/2040 [1:11:27<6:38:27, 16.08s/it]08/28/2023 23:34:19 - INFO - __main__ -   Step: 553, LR: 1.5027791814047501e-05, Loss: 0.5492491722106934
[2023-08-28 23:34:34,655] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 554/2040 [1:11:42<6:29:15, 15.72s/it]08/28/2023 23:34:34 - INFO - __main__ -   Step: 554, LR: 1.501768569984841e-05, Loss: 0.5507381558418274
[2023-08-28 23:34:52,419] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 555/2040 [1:12:00<6:44:11, 16.33s/it]08/28/2023 23:34:52 - INFO - __main__ -   Step: 555, LR: 1.500757958564932e-05, Loss: 0.5509554147720337
[2023-08-28 23:35:09,290] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 556/2040 [1:12:16<6:47:55, 16.49s/it]08/28/2023 23:35:09 - INFO - __main__ -   Step: 556, LR: 1.4997473471450228e-05, Loss: 0.6049785614013672
[2023-08-28 23:35:26,575] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 557/2040 [1:12:34<6:53:31, 16.73s/it]08/28/2023 23:35:26 - INFO - __main__ -   Step: 557, LR: 1.498736735725114e-05, Loss: 0.5259996652603149
[2023-08-28 23:35:41,641] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 558/2040 [1:12:49<6:40:54, 16.23s/it]08/28/2023 23:35:41 - INFO - __main__ -   Step: 558, LR: 1.4977261243052048e-05, Loss: 0.49381333589553833
[2023-08-28 23:35:58,256] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 559/2040 [1:13:05<6:43:28, 16.35s/it]08/28/2023 23:35:58 - INFO - __main__ -   Step: 559, LR: 1.4967155128852957e-05, Loss: 0.5796748995780945
[2023-08-28 23:36:16,005] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 27%|██▋       | 560/2040 [1:13:23<6:53:35, 16.77s/it]08/28/2023 23:36:16 - INFO - __main__ -   Step: 560, LR: 1.4957049014653866e-05, Loss: 0.5745115280151367
[2023-08-28 23:36:31,240] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 561/2040 [1:13:38<6:41:58, 16.31s/it]08/28/2023 23:36:31 - INFO - __main__ -   Step: 561, LR: 1.4946942900454777e-05, Loss: 0.5412263870239258
[2023-08-28 23:36:46,842] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 562/2040 [1:13:54<6:36:29, 16.10s/it]08/28/2023 23:36:46 - INFO - __main__ -   Step: 562, LR: 1.4936836786255686e-05, Loss: 0.7118033170700073
[2023-08-28 23:37:01,362] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 563/2040 [1:14:08<6:24:35, 15.62s/it]08/28/2023 23:37:01 - INFO - __main__ -   Step: 563, LR: 1.4926730672056595e-05, Loss: 0.5743639469146729
[2023-08-28 23:37:16,212] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 564/2040 [1:14:23<6:18:37, 15.39s/it]08/28/2023 23:37:16 - INFO - __main__ -   Step: 564, LR: 1.4916624557857504e-05, Loss: 0.5407106876373291
[2023-08-28 23:37:32,508] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 565/2040 [1:14:40<6:25:02, 15.66s/it]08/28/2023 23:37:32 - INFO - __main__ -   Step: 565, LR: 1.4906518443658415e-05, Loss: 0.5869913101196289
[2023-08-28 23:37:50,105] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 566/2040 [1:14:57<6:39:01, 16.24s/it]08/28/2023 23:37:50 - INFO - __main__ -   Step: 566, LR: 1.4896412329459324e-05, Loss: 0.5408965945243835
[2023-08-28 23:38:07,911] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 567/2040 [1:15:15<6:50:16, 16.71s/it]08/28/2023 23:38:07 - INFO - __main__ -   Step: 567, LR: 1.4886306215260233e-05, Loss: 0.5126000642776489
[2023-08-28 23:38:29,535] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 568/2040 [1:15:37<7:26:09, 18.19s/it]08/28/2023 23:38:29 - INFO - __main__ -   Step: 568, LR: 1.4876200101061142e-05, Loss: 0.5360875129699707
[2023-08-28 23:38:47,376] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 569/2040 [1:15:55<7:23:18, 18.08s/it]08/28/2023 23:38:47 - INFO - __main__ -   Step: 569, LR: 1.4866093986862053e-05, Loss: 0.5937410593032837
[2023-08-28 23:39:07,015] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 570/2040 [1:16:14<7:34:27, 18.55s/it]08/28/2023 23:39:07 - INFO - __main__ -   Step: 570, LR: 1.4855987872662962e-05, Loss: 0.48092928528785706
[2023-08-28 23:39:29,018] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 571/2040 [1:16:36<7:59:30, 19.59s/it]08/28/2023 23:39:29 - INFO - __main__ -   Step: 571, LR: 1.4845881758463871e-05, Loss: 0.5238490104675293
[2023-08-28 23:39:44,676] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 572/2040 [1:16:52<7:30:21, 18.41s/it]08/28/2023 23:39:44 - INFO - __main__ -   Step: 572, LR: 1.483577564426478e-05, Loss: 0.5638433694839478
[2023-08-28 23:40:01,863] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 573/2040 [1:17:09<7:21:06, 18.04s/it]08/28/2023 23:40:01 - INFO - __main__ -   Step: 573, LR: 1.4825669530065691e-05, Loss: 0.5118860602378845
[2023-08-28 23:40:16,862] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 574/2040 [1:17:24<6:58:30, 17.13s/it]08/28/2023 23:40:16 - INFO - __main__ -   Step: 574, LR: 1.48155634158666e-05, Loss: 0.5038313865661621
[2023-08-28 23:40:33,869] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 575/2040 [1:17:41<6:57:19, 17.09s/it]08/28/2023 23:40:33 - INFO - __main__ -   Step: 575, LR: 1.480545730166751e-05, Loss: 0.562771201133728
[2023-08-28 23:40:48,277] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 576/2040 [1:17:55<6:37:23, 16.29s/it]08/28/2023 23:40:48 - INFO - __main__ -   Step: 576, LR: 1.4795351187468418e-05, Loss: 0.5854649543762207
[2023-08-28 23:41:03,228] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 577/2040 [1:18:10<6:27:21, 15.89s/it]08/28/2023 23:41:03 - INFO - __main__ -   Step: 577, LR: 1.478524507326933e-05, Loss: 0.5099304914474487
[2023-08-28 23:41:18,491] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 578/2040 [1:18:26<6:22:32, 15.70s/it]08/28/2023 23:41:18 - INFO - __main__ -   Step: 578, LR: 1.4775138959070238e-05, Loss: 0.6032909154891968
[2023-08-28 23:41:35,939] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 579/2040 [1:18:43<6:35:02, 16.22s/it]08/28/2023 23:41:35 - INFO - __main__ -   Step: 579, LR: 1.4765032844871147e-05, Loss: 0.5620352625846863
[2023-08-28 23:41:52,902] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 580/2040 [1:19:00<6:40:10, 16.45s/it]08/28/2023 23:41:52 - INFO - __main__ -   Step: 580, LR: 1.4754926730672056e-05, Loss: 0.6139916777610779
[2023-08-28 23:42:09,759] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 28%|██▊       | 581/2040 [1:19:17<6:42:54, 16.57s/it]08/28/2023 23:42:09 - INFO - __main__ -   Step: 581, LR: 1.4744820616472967e-05, Loss: 0.5530418157577515
[2023-08-28 23:42:25,157] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▊       | 582/2040 [1:19:32<6:34:05, 16.22s/it]08/28/2023 23:42:25 - INFO - __main__ -   Step: 582, LR: 1.4734714502273876e-05, Loss: 0.5153110027313232
[2023-08-28 23:42:41,595] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▊       | 583/2040 [1:19:49<6:35:25, 16.28s/it]08/28/2023 23:42:41 - INFO - __main__ -   Step: 583, LR: 1.4724608388074785e-05, Loss: 0.5263881683349609
[2023-08-28 23:42:59,574] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▊       | 584/2040 [1:20:07<6:47:29, 16.79s/it]08/28/2023 23:42:59 - INFO - __main__ -   Step: 584, LR: 1.4714502273875698e-05, Loss: 0.6153243184089661
[2023-08-28 23:43:16,175] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▊       | 585/2040 [1:20:23<6:45:49, 16.73s/it]08/28/2023 23:43:16 - INFO - __main__ -   Step: 585, LR: 1.4704396159676607e-05, Loss: 0.5254178643226624
[2023-08-28 23:43:31,174] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▊       | 586/2040 [1:20:38<6:32:55, 16.21s/it]08/28/2023 23:43:31 - INFO - __main__ -   Step: 586, LR: 1.4694290045477514e-05, Loss: 0.6052059531211853
[2023-08-28 23:43:45,975] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 587/2040 [1:20:53<6:22:23, 15.79s/it]08/28/2023 23:43:45 - INFO - __main__ -   Step: 587, LR: 1.4684183931278423e-05, Loss: 0.612029492855072
[2023-08-28 23:44:04,587] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 588/2040 [1:21:12<6:42:36, 16.64s/it]08/28/2023 23:44:04 - INFO - __main__ -   Step: 588, LR: 1.4674077817079336e-05, Loss: 0.5378637313842773
[2023-08-28 23:44:22,403] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 589/2040 [1:21:30<6:50:53, 16.99s/it]08/28/2023 23:44:22 - INFO - __main__ -   Step: 589, LR: 1.4663971702880245e-05, Loss: 0.5261476039886475
[2023-08-28 23:44:37,377] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 590/2040 [1:21:45<6:35:59, 16.39s/it]08/28/2023 23:44:37 - INFO - __main__ -   Step: 590, LR: 1.4653865588681154e-05, Loss: 0.5120560526847839
[2023-08-28 23:44:51,793] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 591/2040 [1:21:59<6:21:26, 15.79s/it]08/28/2023 23:44:51 - INFO - __main__ -   Step: 591, LR: 1.4643759474482061e-05, Loss: 0.5772080421447754
[2023-08-28 23:45:07,542] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 592/2040 [1:22:15<6:20:50, 15.78s/it]08/28/2023 23:45:07 - INFO - __main__ -   Step: 592, LR: 1.4633653360282974e-05, Loss: 0.5514432191848755
[2023-08-28 23:45:22,385] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 593/2040 [1:22:30<6:13:47, 15.50s/it]08/28/2023 23:45:22 - INFO - __main__ -   Step: 593, LR: 1.4623547246083883e-05, Loss: 0.6058050394058228
[2023-08-28 23:45:38,083] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 594/2040 [1:22:45<6:14:58, 15.56s/it]08/28/2023 23:45:38 - INFO - __main__ -   Step: 594, LR: 1.4613441131884792e-05, Loss: 0.5736321210861206
[2023-08-28 23:45:54,463] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 595/2040 [1:23:02<6:20:38, 15.81s/it]08/28/2023 23:45:54 - INFO - __main__ -   Step: 595, LR: 1.4603335017685701e-05, Loss: 0.552312970161438
[2023-08-28 23:46:11,429] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 596/2040 [1:23:19<6:28:45, 16.15s/it]08/28/2023 23:46:11 - INFO - __main__ -   Step: 596, LR: 1.4593228903486612e-05, Loss: 0.5130829811096191
[2023-08-28 23:46:26,211] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 597/2040 [1:23:33<6:18:35, 15.74s/it]08/28/2023 23:46:26 - INFO - __main__ -   Step: 597, LR: 1.458312278928752e-05, Loss: 0.580346941947937
[2023-08-28 23:46:43,213] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 598/2040 [1:23:50<6:27:24, 16.12s/it]08/28/2023 23:46:43 - INFO - __main__ -   Step: 598, LR: 1.457301667508843e-05, Loss: 0.5103103518486023
[2023-08-28 23:47:00,000] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 599/2040 [1:24:07<6:31:57, 16.32s/it]08/28/2023 23:47:00 - INFO - __main__ -   Step: 599, LR: 1.4562910560889339e-05, Loss: 0.5778638124465942
[2023-08-28 23:47:15,107] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 600/2040 [1:24:22<6:22:56, 15.96s/it]08/28/2023 23:47:15 - INFO - __main__ -   Step: 600, LR: 1.455280444669025e-05, Loss: 0.5030065774917603
08/28/2023 23:47:15 - INFO - accelerate.accelerator - Saving current state to /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600
08/28/2023 23:47:15 - INFO - accelerate.accelerator - Saving DeepSpeed Model and Optimizer
[2023-08-28 23:47:15,117] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint pytorch_model is about to be saved!
[2023-08-28 23:47:15,124] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt
[2023-08-28 23:47:15,125] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2023-08-28 23:47:15,139] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2023-08-28 23:47:15,249] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt
[2023-08-28 23:47:15,249] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt...
[2023-08-28 23:47:15,264] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_1_mp_rank_00_model_states.pt.
[2023-08-28 23:47:15,272] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt...
[2023-08-28 23:47:15,274] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt...
[2023-08-28 23:47:15,286] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_3_mp_rank_00_model_states.pt.
[2023-08-28 23:47:15,289] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/zero_pp_rank_2_mp_rank_00_model_states.pt.
[2023-08-28 23:47:15,290] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt...
[2023-08-28 23:47:15,290] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt...
[2023-08-28 23:47:15,290] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt...
[2023-08-28 23:47:15,290] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2023-08-28 23:48:12,318] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt.
[2023-08-28 23:48:12,318] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt
[2023-08-28 23:48:13,511] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2023-08-28 23:48:13,511] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2023-08-28 23:48:16,883] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt.
[2023-08-28 23:48:16,883] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt
[2023-08-28 23:48:17,505] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt.
[2023-08-28 23:48:17,505] [INFO] [engine.py:3285:_save_zero_checkpoint] zero checkpoint saved /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt
[2023-08-28 23:48:17,510] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 23:48:17,510] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 23:48:17,510] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
[2023-08-28 23:48:17,511] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint pytorch_model is ready now!
08/28/2023 23:48:17 - INFO - accelerate.accelerator - DeepSpeed Model and Optimizer saved to output dir /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/pytorch_model
08/28/2023 23:48:17 - INFO - accelerate.checkpointing - Scheduler state saved in /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/scheduler.bin
08/28/2023 23:48:17 - INFO - accelerate.checkpointing - Random states saved in /data/users/zhangjunlei/tyx/reward-by-prm800k/models/llama2-13b-direct-prediction-bs=128-gas=16/step_600/random_states_0.pkl
[2023-08-28 23:48:32,171] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 29%|██▉       | 601/2040 [1:25:39<13:42:21, 34.29s/it]08/28/2023 23:48:32 - INFO - __main__ -   Step: 601, LR: 1.4542698332491159e-05, Loss: 0.5236946940422058
[2023-08-28 23:48:52,122] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 602/2040 [1:25:59<11:58:41, 29.99s/it]08/28/2023 23:48:52 - INFO - __main__ -   Step: 602, LR: 1.4532592218292068e-05, Loss: 0.5318029522895813
[2023-08-28 23:49:08,331] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 603/2040 [1:26:15<10:19:11, 25.85s/it]08/28/2023 23:49:08 - INFO - __main__ -   Step: 603, LR: 1.4522486104092977e-05, Loss: 0.5138273239135742
[2023-08-28 23:49:25,198] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 604/2040 [1:26:32<9:14:14, 23.16s/it] 08/28/2023 23:49:25 - INFO - __main__ -   Step: 604, LR: 1.4512379989893888e-05, Loss: 0.5141012072563171
[2023-08-28 23:49:39,811] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 605/2040 [1:26:47<8:12:33, 20.59s/it]08/28/2023 23:49:39 - INFO - __main__ -   Step: 605, LR: 1.4502273875694797e-05, Loss: 0.5924780368804932
[2023-08-28 23:49:56,288] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 606/2040 [1:27:03<7:42:41, 19.36s/it]08/28/2023 23:49:56 - INFO - __main__ -   Step: 606, LR: 1.4492167761495706e-05, Loss: 0.553874135017395
[2023-08-28 23:50:10,911] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 607/2040 [1:27:18<7:08:25, 17.94s/it]08/28/2023 23:50:10 - INFO - __main__ -   Step: 607, LR: 1.4482061647296615e-05, Loss: 0.596671998500824
[2023-08-28 23:50:27,400] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 608/2040 [1:27:35<6:57:44, 17.50s/it]08/28/2023 23:50:27 - INFO - __main__ -   Step: 608, LR: 1.4471955533097526e-05, Loss: 0.5860311388969421
[2023-08-28 23:50:43,903] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 609/2040 [1:27:51<6:50:17, 17.20s/it]08/28/2023 23:50:43 - INFO - __main__ -   Step: 609, LR: 1.4461849418898435e-05, Loss: 0.4921987056732178
[2023-08-28 23:50:59,112] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 610/2040 [1:28:06<6:35:45, 16.60s/it]08/28/2023 23:50:59 - INFO - __main__ -   Step: 610, LR: 1.4451743304699344e-05, Loss: 0.6343059539794922
[2023-08-28 23:51:14,543] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|██▉       | 611/2040 [1:28:22<6:27:05, 16.25s/it]08/28/2023 23:51:14 - INFO - __main__ -   Step: 611, LR: 1.4441637190500253e-05, Loss: 0.5922890305519104
[2023-08-28 23:51:29,315] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 612/2040 [1:28:36<6:16:14, 15.81s/it]08/28/2023 23:51:29 - INFO - __main__ -   Step: 612, LR: 1.4431531076301164e-05, Loss: 0.5791494250297546
[2023-08-28 23:51:45,114] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 613/2040 [1:28:52<6:15:54, 15.81s/it]08/28/2023 23:51:45 - INFO - __main__ -   Step: 613, LR: 1.4421424962102073e-05, Loss: 0.580212414264679
[2023-08-28 23:52:01,990] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 614/2040 [1:29:09<6:23:17, 16.13s/it]08/28/2023 23:52:01 - INFO - __main__ -   Step: 614, LR: 1.4411318847902982e-05, Loss: 0.651407778263092
[2023-08-28 23:52:16,943] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 615/2040 [1:29:24<6:14:38, 15.77s/it]08/28/2023 23:52:16 - INFO - __main__ -   Step: 615, LR: 1.4401212733703891e-05, Loss: 0.5112379789352417
[2023-08-28 23:52:33,610] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 616/2040 [1:29:41<6:20:44, 16.04s/it]08/28/2023 23:52:33 - INFO - __main__ -   Step: 616, LR: 1.4391106619504802e-05, Loss: 0.5411680340766907
[2023-08-28 23:52:50,404] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 617/2040 [1:29:58<6:25:49, 16.27s/it]08/28/2023 23:52:50 - INFO - __main__ -   Step: 617, LR: 1.438100050530571e-05, Loss: 0.517385721206665
[2023-08-28 23:53:05,937] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 618/2040 [1:30:13<6:20:19, 16.05s/it]08/28/2023 23:53:05 - INFO - __main__ -   Step: 618, LR: 1.437089439110662e-05, Loss: 0.547204852104187
[2023-08-28 23:53:21,263] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 619/2040 [1:30:28<6:14:55, 15.83s/it]08/28/2023 23:53:21 - INFO - __main__ -   Step: 619, LR: 1.436078827690753e-05, Loss: 0.5445727109909058
[2023-08-28 23:53:35,801] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 620/2040 [1:30:43<6:05:29, 15.44s/it]08/28/2023 23:53:35 - INFO - __main__ -   Step: 620, LR: 1.435068216270844e-05, Loss: 0.6283406019210815
[2023-08-28 23:53:52,267] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 621/2040 [1:30:59<6:12:29, 15.75s/it]08/28/2023 23:53:52 - INFO - __main__ -   Step: 621, LR: 1.4340576048509349e-05, Loss: 0.5405393838882446
[2023-08-28 23:54:07,782] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 30%|███       | 622/2040 [1:31:15<6:10:33, 15.68s/it]08/28/2023 23:54:07 - INFO - __main__ -   Step: 622, LR: 1.4330469934310258e-05, Loss: 0.5305676460266113
[2023-08-28 23:54:24,394] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 623/2040 [1:31:32<6:16:54, 15.96s/it]08/28/2023 23:54:24 - INFO - __main__ -   Step: 623, LR: 1.4320363820111169e-05, Loss: 0.6274248361587524
[2023-08-28 23:54:40,906] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 624/2040 [1:31:48<6:20:33, 16.13s/it]08/28/2023 23:54:40 - INFO - __main__ -   Step: 624, LR: 1.4310257705912078e-05, Loss: 0.618395984172821
[2023-08-28 23:54:56,479] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 625/2040 [1:32:04<6:16:22, 15.96s/it]08/28/2023 23:54:56 - INFO - __main__ -   Step: 625, LR: 1.4300151591712987e-05, Loss: 0.5916075706481934
[2023-08-28 23:55:13,325] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 626/2040 [1:32:20<6:22:22, 16.23s/it]08/28/2023 23:55:13 - INFO - __main__ -   Step: 626, LR: 1.4290045477513896e-05, Loss: 0.6035862565040588
[2023-08-28 23:55:30,081] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 627/2040 [1:32:37<6:25:51, 16.38s/it]08/28/2023 23:55:30 - INFO - __main__ -   Step: 627, LR: 1.4279939363314808e-05, Loss: 0.5162246227264404
[2023-08-28 23:55:44,662] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 628/2040 [1:32:52<6:12:51, 15.84s/it]08/28/2023 23:55:44 - INFO - __main__ -   Step: 628, LR: 1.4269833249115717e-05, Loss: 0.5213053226470947
[2023-08-28 23:55:59,689] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 629/2040 [1:33:07<6:06:49, 15.60s/it]08/28/2023 23:55:59 - INFO - __main__ -   Step: 629, LR: 1.4259727134916625e-05, Loss: 0.6012848615646362
[2023-08-28 23:56:13,963] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 630/2040 [1:33:21<5:57:13, 15.20s/it]08/28/2023 23:56:13 - INFO - __main__ -   Step: 630, LR: 1.4249621020717534e-05, Loss: 0.5682415962219238
[2023-08-28 23:56:28,354] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 631/2040 [1:33:35<5:51:16, 14.96s/it]08/28/2023 23:56:28 - INFO - __main__ -   Step: 631, LR: 1.4239514906518446e-05, Loss: 0.5706632137298584
[2023-08-28 23:56:42,313] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 632/2040 [1:33:49<5:43:59, 14.66s/it]08/28/2023 23:56:42 - INFO - __main__ -   Step: 632, LR: 1.4229408792319355e-05, Loss: 0.6346297860145569
[2023-08-28 23:56:58,779] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 633/2040 [1:34:06<5:56:27, 15.20s/it]08/28/2023 23:56:58 - INFO - __main__ -   Step: 633, LR: 1.4219302678120264e-05, Loss: 0.6381422281265259
[2023-08-28 23:57:17,356] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 634/2040 [1:34:24<6:19:56, 16.21s/it]08/28/2023 23:57:17 - INFO - __main__ -   Step: 634, LR: 1.4209196563921172e-05, Loss: 0.5044545531272888
[2023-08-28 23:57:34,051] [WARNING] [stage3.py:1898:step] 2 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
 31%|███       | 635/2040 [1:34:41<6:23:02, 16.36s/it]08/28/2023 23:57:34 - INFO - __main__ -   Step: 635, LR: 1.4199090449722084e-05, Loss: 0.5394690036773682
WARNING:torch.distributed.elastic.agent.server.api:Received 15 death signal, shutting down workers
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2434984 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2434985 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2434986 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2434987 closing signal SIGTERM
Traceback (most recent call last):
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/accelerate/commands/accelerate_cli.py", line 45, in main
    args.func(args)
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/accelerate/commands/launch.py", line 964, in launch_command
    deepspeed_launcher(args)
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/accelerate/commands/launch.py", line 687, in deepspeed_launcher
    distrib_run.run(args)
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 241, in launch_agent
    result = agent.run()
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/distributed/elastic/metrics/api.py", line 129, in wrapper
    result = f(*args, **kwargs)
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 723, in run
    result = self._invoke_run(role)
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 864, in _invoke_run
    time.sleep(monitor_interval)
  File "/data/users/zhangjunlei/anaconda3/envs/open-instruct/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2434821 got signal: 15
