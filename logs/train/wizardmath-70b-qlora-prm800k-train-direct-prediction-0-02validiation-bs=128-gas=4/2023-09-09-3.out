nohup: ignoring input
[2023-09-10 02:03:38,052] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-10 02:03:40,550] [WARNING] [runner.py:196:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2023-09-10 02:03:40,551] [INFO] [runner.py:555:main] cmd = /data/users/zhangjunlei/anaconda3/envs/open-instruct/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMSwgMywgNCwgNl19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None /data/users/zhangjunlei/tyx/FastChat/fastchat/train/train_qlora_flash_attn_2.py --model_name_or_path /data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--WizardLM--WizardMath-70B-V1.0/snapshots/e089c3f9d2ad9d1acb62425aec3f4126f498f4c5 --encoded_datasets_path /data/users/zhangjunlei/tyx/reward-by-prm800k/datasets/prm800k-train-direct-prediction-0-02validiation-encoded-datasets --output_dir /data/users/zhangjunlei/tyx/reward-by-prm800k/models/wizardmath-70b-qlora-prm800k-train-direct-prediction-0-02validiation-bs=128-gas=4 --model_max_length 1024 --per_device_train_batch_size 8 --per_device_eval_batch_size 8 --gradient_checkpointing True --gradient_accumulation_steps 4 --num_train_epochs 100 --evaluation_strategy steps --eval_steps 100 --eval_first False --save_strategy steps --save_steps 100 --load_best_model_at_end True --metric_for_best_model f1_-1 --greater_is_better True --learning_rate 2e-5 --weight_decay 0. --warmup_ratio 0.03 --lr_scheduler_type linear --lora_r 16 --lora_alpha 16 --lora_dropout 0.05 --lora_target_modules all_linear --q_lora True --bf16 True --tf32 True --use_accelerate_lib flash-attn-v2 --deepspeed /data/users/zhangjunlei/tyx/reward-by-prm800k/ds_configs/stage0.conf --logging_strategy steps --logging_steps 1 --custom_debug True
[2023-09-10 02:03:41,991] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-10 02:03:43,492] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [1, 3, 4, 6]}
[2023-09-10 02:03:43,492] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=4, node_rank=0
[2023-09-10 02:03:43,492] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2023-09-10 02:03:43,492] [INFO] [launch.py:163:main] dist_world_size=4
[2023-09-10 02:03:43,492] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=1,3,4,6
[2023-09-10 02:03:46,228] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-10 02:03:46,332] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-10 02:03:46,397] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-10 02:03:46,401] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-10 02:03:47,859] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-10 02:03:47,859] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-09-10 02:03:47,935] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-10 02:03:47,935] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-09-10 02:03:48,400] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-10 02:03:48,400] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-09-10 02:03:48,400] [INFO] [comm.py:643:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2023-09-10 02:03:48,536] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-10 02:03:48,537] [INFO] [comm.py:616:init_distributed] cdb=None

Loading checkpoint shards:   0%|          | 0/29 [00:00<?, ?it/s]Sun Sep 10 02:03:49 2023
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.48.07    Driver Version: 515.48.07    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:12:00.0 Off |                    0 |
| N/A   33C    P0    83W / 400W |   1114MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  On   | 00000000:18:00.0 Off |                    0 |
| N/A   31C    P0    66W / 400W |     28MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  On   | 00000000:4A:00.0 Off |                    0 |
| N/A   31C    P0    89W / 400W |  42836MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  On   | 00000000:4E:00.0 Off |                    0 |
| N/A   30C    P0    64W / 400W |     28MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM...  On   | 00000000:8A:00.0 Off |                    0 |
| N/A   35C    P0    73W / 400W |     28MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM...  On   | 00000000:8F:00.0 Off |                    0 |
| N/A   35C    P0    72W / 400W |   2785MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM...  On   | 00000000:C6:00.0 Off |                    0 |
| N/A   33C    P0    66W / 400W |     28MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM...  On   | 00000000:CA:00.0 Off |                    0 |
| N/A   35C    P0    72W / 400W |  23751MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A    242938      C   python3                           555MiB |
|    0   N/A  N/A   2724011      C   python3                           555MiB |
|    2   N/A  N/A    187985      C   python                          37871MiB |
|    2   N/A  N/A    242938      C   python3                          4963MiB |
|    5   N/A  N/A   2724011      C   python3                          2783MiB |
|    7   N/A  N/A   1004856      C   python                          23747MiB |
+-----------------------------------------------------------------------------+


Loading checkpoint shards:   0%|          | 0/29 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/29 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/29 [00:00<?, ?it/s]
Loading checkpoint shards:   3%|â–Ž         | 1/29 [00:06<03:08,  6.74s/it]
Loading checkpoint shards:   3%|â–Ž         | 1/29 [00:06<02:49,  6.07s/it]
Loading checkpoint shards:   3%|â–Ž         | 1/29 [00:07<03:32,  7.58s/it]
Loading checkpoint shards:   7%|â–‹         | 2/29 [00:12<02:41,  5.97s/it]
Loading checkpoint shards:   3%|â–Ž         | 1/29 [00:07<03:38,  7.80s/it]
Loading checkpoint shards:   7%|â–‹         | 2/29 [00:10<02:16,  5.06s/it]
Loading checkpoint shards:   7%|â–‹         | 2/29 [00:12<02:44,  6.09s/it]
Loading checkpoint shards:   7%|â–‹         | 2/29 [00:13<03:04,  6.85s/it]
Loading checkpoint shards:  10%|â–ˆ         | 3/29 [00:18<02:43,  6.28s/it]
Loading checkpoint shards:  10%|â–ˆ         | 3/29 [00:14<02:05,  4.81s/it]
Loading checkpoint shards:  10%|â–ˆ         | 3/29 [00:17<02:22,  5.48s/it]
Loading checkpoint shards:  10%|â–ˆ         | 3/29 [00:20<02:48,  6.49s/it]
Loading checkpoint shards:  14%|â–ˆâ–        | 4/29 [00:19<02:02,  4.89s/it]
Loading checkpoint shards:  14%|â–ˆâ–        | 4/29 [00:24<02:32,  6.10s/it]
Loading checkpoint shards:  14%|â–ˆâ–        | 4/29 [00:23<02:18,  5.54s/it]
Loading checkpoint shards:  17%|â–ˆâ–‹        | 5/29 [00:23<01:48,  4.50s/it]
Loading checkpoint shards:  17%|â–ˆâ–‹        | 5/29 [00:30<02:24,  6.04s/it]
Loading checkpoint shards:  17%|â–ˆâ–‹        | 5/29 [00:27<02:01,  5.05s/it]
Loading checkpoint shards:  14%|â–ˆâ–        | 4/29 [00:26<02:40,  6.42s/it]
Loading checkpoint shards:  21%|â–ˆâ–ˆ        | 6/29 [00:29<01:51,  4.86s/it]
Loading checkpoint shards:  21%|â–ˆâ–ˆ        | 6/29 [00:31<01:48,  4.73s/it]
Loading checkpoint shards:  21%|â–ˆâ–ˆ        | 6/29 [00:35<02:13,  5.81s/it]
Loading checkpoint shards:  17%|â–ˆâ–‹        | 5/29 [00:31<02:25,  6.05s/it]
Loading checkpoint shards:  24%|â–ˆâ–ˆâ–       | 7/29 [00:33<01:42,  4.67s/it]
Loading checkpoint shards:  24%|â–ˆâ–ˆâ–       | 7/29 [00:35<01:40,  4.55s/it]
Loading checkpoint shards:  24%|â–ˆâ–ˆâ–       | 7/29 [00:42<02:10,  5.92s/it]
Loading checkpoint shards:  21%|â–ˆâ–ˆ        | 6/29 [00:38<02:23,  6.22s/it]
Loading checkpoint shards:  28%|â–ˆâ–ˆâ–Š       | 8/29 [00:38<01:41,  4.82s/it]
Loading checkpoint shards:  28%|â–ˆâ–ˆâ–Š       | 8/29 [00:40<01:36,  4.62s/it]
Loading checkpoint shards:  28%|â–ˆâ–ˆâ–Š       | 8/29 [00:47<02:03,  5.89s/it]
Loading checkpoint shards:  31%|â–ˆâ–ˆâ–ˆ       | 9/29 [00:44<01:31,  4.56s/it]
Loading checkpoint shards:  24%|â–ˆâ–ˆâ–       | 7/29 [00:43<02:12,  6.01s/it]
Loading checkpoint shards:  31%|â–ˆâ–ˆâ–ˆ       | 9/29 [00:45<01:49,  5.49s/it]
Loading checkpoint shards:  34%|â–ˆâ–ˆâ–ˆâ–      | 10/29 [00:49<01:30,  4.74s/it]
Loading checkpoint shards:  31%|â–ˆâ–ˆâ–ˆ       | 9/29 [00:54<01:59,  5.97s/it]
Loading checkpoint shards:  28%|â–ˆâ–ˆâ–Š       | 8/29 [00:49<02:06,  6.02s/it]
Loading checkpoint shards:  34%|â–ˆâ–ˆâ–ˆâ–      | 10/29 [00:50<01:40,  5.29s/it]
Loading checkpoint shards:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 11/29 [00:54<01:22,  4.60s/it]
Loading checkpoint shards:  34%|â–ˆâ–ˆâ–ˆâ–      | 10/29 [00:59<01:48,  5.71s/it]
Loading checkpoint shards:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 11/29 [00:54<01:30,  5.02s/it]
Loading checkpoint shards:  31%|â–ˆâ–ˆâ–ˆ       | 9/29 [00:55<01:56,  5.84s/it]
Loading checkpoint shards:  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/29 [00:58<01:15,  4.42s/it]
Loading checkpoint shards:  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/29 [00:59<01:23,  4.92s/it]
Loading checkpoint shards:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 11/29 [01:05<01:44,  5.82s/it]
Loading checkpoint shards:  34%|â–ˆâ–ˆâ–ˆâ–      | 10/29 [01:01<01:51,  5.85s/it]
Loading checkpoint shards:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 13/29 [01:02<01:09,  4.37s/it]
Loading checkpoint shards:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 13/29 [01:04<01:19,  4.98s/it]
Loading checkpoint shards:  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/29 [01:10<01:35,  5.61s/it]
Loading checkpoint shards:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 14/29 [01:06<01:06,  4.45s/it]
Loading checkpoint shards:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 11/29 [01:06<01:41,  5.64s/it]
Loading checkpoint shards:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 14/29 [01:09<01:13,  4.89s/it]
Loading checkpoint shards:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 15/29 [01:10<01:00,  4.30s/it]
Loading checkpoint shards:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 13/29 [01:16<01:34,  5.90s/it]
Loading checkpoint shards:  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/29 [01:12<01:38,  5.81s/it]
Loading checkpoint shards:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 15/29 [01:13<01:06,  4.77s/it]
Loading checkpoint shards:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 16/29 [01:16<01:00,  4.67s/it]
Loading checkpoint shards:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 14/29 [01:22<01:25,  5.68s/it]
Loading checkpoint shards:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 13/29 [01:17<01:30,  5.65s/it]
Loading checkpoint shards:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 16/29 [01:19<01:04,  4.99s/it]
Loading checkpoint shards:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 17/29 [01:20<00:55,  4.59s/it]
Loading checkpoint shards:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 15/29 [01:28<01:22,  5.90s/it]
Loading checkpoint shards:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 14/29 [01:24<01:28,  5.90s/it]
Loading checkpoint shards:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 17/29 [01:24<00:59,  4.99s/it]
Loading checkpoint shards:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/29 [01:25<00:51,  4.68s/it]
Loading checkpoint shards:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/29 [01:28<00:52,  4.75s/it]
Loading checkpoint shards:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 16/29 [01:33<01:14,  5.74s/it]
Loading checkpoint shards:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 15/29 [01:29<01:20,  5.77s/it]
Loading checkpoint shards:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 19/29 [01:30<00:47,  4.79s/it]
Loading checkpoint shards:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 19/29 [01:33<00:47,  4.72s/it]
Loading checkpoint shards:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 20/29 [01:36<00:45,  5.02s/it]
Loading checkpoint shards:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 17/29 [01:40<01:10,  5.89s/it]
Loading checkpoint shards:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 16/29 [01:35<01:16,  5.86s/it]
Loading checkpoint shards:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 20/29 [01:38<00:44,  4.99s/it]
Loading checkpoint shards:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 21/29 [01:40<00:37,  4.69s/it]
Loading checkpoint shards:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 17/29 [01:41<01:08,  5.68s/it]
Loading checkpoint shards:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/29 [01:46<01:07,  6.13s/it]
Loading checkpoint shards:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 22/29 [01:44<00:32,  4.61s/it]
Loading checkpoint shards:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 21/29 [01:43<00:39,  4.95s/it]
Loading checkpoint shards:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/29 [01:46<01:02,  5.64s/it]
Loading checkpoint shards:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 19/29 [01:52<00:59,  5.96s/it]
Loading checkpoint shards:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 23/29 [01:49<00:27,  4.63s/it]
Loading checkpoint shards:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 22/29 [01:48<00:34,  4.92s/it]
Loading checkpoint shards:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 19/29 [01:51<00:55,  5.53s/it]
Loading checkpoint shards:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 24/29 [01:53<00:22,  4.46s/it]
Loading checkpoint shards:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 20/29 [01:57<00:51,  5.71s/it]
Loading checkpoint shards:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 23/29 [01:54<00:31,  5.31s/it]
Loading checkpoint shards:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 25/29 [01:57<00:17,  4.28s/it]
Loading checkpoint shards:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 20/29 [01:58<00:51,  5.73s/it]
Loading checkpoint shards:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 21/29 [02:03<00:45,  5.65s/it]
Loading checkpoint shards:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 24/29 [01:59<00:25,  5.11s/it]
Loading checkpoint shards:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 26/29 [02:02<00:13,  4.58s/it]
Loading checkpoint shards:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 21/29 [02:03<00:43,  5.48s/it]
Loading checkpoint shards:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 25/29 [02:03<00:18,  4.74s/it]
Loading checkpoint shards:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 22/29 [02:08<00:38,  5.51s/it]
Loading checkpoint shards:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 27/29 [02:06<00:08,  4.50s/it]
Loading checkpoint shards:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 26/29 [02:07<00:13,  4.59s/it]
Loading checkpoint shards:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 22/29 [02:07<00:37,  5.30s/it]
Loading checkpoint shards:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 23/29 [02:14<00:34,  5.72s/it]
Loading checkpoint shards:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 28/29 [02:11<00:04,  4.43s/it]
Loading checkpoint shards:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 27/29 [02:12<00:09,  4.64s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:14<00:00,  4.10s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:14<00:00,  4.64s/it]

Loading checkpoint shards:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 23/29 [02:13<00:32,  5.47s/it]Sun Sep 10 02:06:11 2023
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.48.07    Driver Version: 515.48.07    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:12:00.0 Off |                    0 |
| N/A   32C    P0    67W / 400W |   1114MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  On   | 00000000:18:00.0 Off |                    0 |
| N/A   32C    P0    82W / 400W |  35483MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  On   | 00000000:4A:00.0 Off |                    0 |
| N/A   31C    P0    74W / 400W |  42836MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  On   | 00000000:4E:00.0 Off |                    0 |
| N/A   31C    P0    67W / 400W |  33211MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM...  On   | 00000000:8A:00.0 Off |                    0 |
| N/A   35C    P0    77W / 400W |  29039MiB / 81920MiB |     16%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM...  On   | 00000000:8F:00.0 Off |                    0 |
| N/A   35C    P0    78W / 400W |   2785MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM...  On   | 00000000:C6:00.0 Off |                    0 |
| N/A   33C    P0    72W / 400W |  28591MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM...  On   | 00000000:CA:00.0 Off |                    0 |
| N/A   35C    P0    84W / 400W |  23751MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A    242938      C   python3                           555MiB |
|    0   N/A  N/A   2724011      C   python3                           555MiB |
|    1   N/A  N/A   2269051      C   .../open-instruct/bin/python    35455MiB |
|    2   N/A  N/A    187985      C   python                          37871MiB |
|    2   N/A  N/A    242938      C   python3                          4963MiB |
|    3   N/A  N/A   2269052      C   .../open-instruct/bin/python    33183MiB |
|    4   N/A  N/A   2269053      C   .../open-instruct/bin/python    29127MiB |
|    5   N/A  N/A   2724011      C   python3                          2783MiB |
|    6   N/A  N/A   2269054      C   .../open-instruct/bin/python    28563MiB |
|    7   N/A  N/A   1004856      C   python                          23747MiB |
+-----------------------------------------------------------------------------+


Loading checkpoint shards:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 24/29 [02:20<00:29,  5.88s/it]
Loading checkpoint shards:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 28/29 [02:16<00:04,  4.46s/it]
Loading checkpoint shards:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 24/29 [02:18<00:26,  5.32s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:19<00:00,  4.01s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:19<00:00,  4.80s/it]

Loading checkpoint shards:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 25/29 [02:26<00:23,  5.81s/it]
Loading checkpoint shards:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 25/29 [02:23<00:21,  5.28s/it]
Loading checkpoint shards:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 26/29 [02:32<00:17,  5.78s/it]
Loading checkpoint shards:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 26/29 [02:28<00:15,  5.09s/it]
Loading checkpoint shards:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 27/29 [02:36<00:10,  5.47s/it]
Loading checkpoint shards:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 27/29 [02:33<00:10,  5.02s/it]
Loading checkpoint shards:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 28/29 [02:41<00:05,  5.33s/it]
Loading checkpoint shards:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 28/29 [02:39<00:05,  5.34s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:45<00:00,  4.73s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:45<00:00,  5.69s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:43<00:00,  4.87s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [02:43<00:00,  5.63s/it]
get_peft_model() took 370.58029222488403 s
Sun Sep 10 02:12:23 2023
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.48.07    Driver Version: 515.48.07    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:12:00.0 Off |                    0 |
| N/A   33C    P0    70W / 400W |   1114MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  On   | 00000000:18:00.0 Off |                    0 |
| N/A   31C    P0    77W / 400W |  37861MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  On   | 00000000:4A:00.0 Off |                    0 |
| N/A   31C    P0    79W / 400W |  42836MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  On   | 00000000:4E:00.0 Off |                    0 |
| N/A   31C    P0    69W / 400W |  37831MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM...  On   | 00000000:8A:00.0 Off |                    0 |
| N/A   35C    P0    74W / 400W |  37831MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM...  On   | 00000000:8F:00.0 Off |                    0 |
| N/A   35C    P0    82W / 400W |   2785MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM...  On   | 00000000:C6:00.0 Off |                    0 |
| N/A   33C    P0    75W / 400W |  37831MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM...  On   | 00000000:CA:00.0 Off |                    0 |
| N/A   34C    P0    72W / 400W |  23751MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A    242938      C   python3                           555MiB |
|    0   N/A  N/A   2724011      C   python3                           555MiB |
|    1   N/A  N/A   2269051      C   .../open-instruct/bin/python    37833MiB |
|    2   N/A  N/A    187985      C   python                          37871MiB |
|    2   N/A  N/A    242938      C   python3                          4963MiB |
|    3   N/A  N/A   2269052      C   .../open-instruct/bin/python    37803MiB |
|    4   N/A  N/A   2269053      C   .../open-instruct/bin/python    37803MiB |
|    5   N/A  N/A   2724011      C   python3                          2783MiB |
|    6   N/A  N/A   2269054      C   .../open-instruct/bin/python    37803MiB |
|    7   N/A  N/A   1004856      C   python                          23747MiB |
+-----------------------------------------------------------------------------+

trainable params: 207,093,760 || all params: 69,183,774,720 || trainable%: 0.2993386250434414
wandb: Currently logged in as: kidrain61. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...
wandb: \ Waiting for wandb.init()...
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /data/users/zhangjunlei/tyx/wandb/wandb/run-20230910_021306-2d2c1dnz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 2023-09-09-3-wizardmath-70b-qlora-prm800k-train-direct-prediction-0-02validiation-bs=128-gas=4
wandb: â­ï¸ View project at https://wandb.ai/kidrain61/step-reward
wandb: ðŸš€ View run at https://wandb.ai/kidrain61/step-reward/runs/2d2c1dnz

  0%|          | 0/66500 [00:00<?, ?it/s]
  0%|          | 1/66500 [01:18<1450:20:16, 78.52s/it]

{'loss': 21.5923, 'learning_rate': 1.0025062656641605e-08, 'epoch': 0.0}

  0%|          | 1/66500 [01:18<1450:20:16, 78.52s/it]
  0%|          | 2/66500 [02:33<1415:07:29, 76.61s/it]

{'loss': 21.4562, 'learning_rate': 2.005012531328321e-08, 'epoch': 0.0}

  0%|          | 2/66500 [02:33<1415:07:29, 76.61s/it]
  0%|          | 3/66500 [03:49<1404:46:51, 76.05s/it]

{'loss': 21.6946, 'learning_rate': 3.0075187969924815e-08, 'epoch': 0.0}

  0%|          | 3/66500 [03:49<1404:46:51, 76.05s/it]