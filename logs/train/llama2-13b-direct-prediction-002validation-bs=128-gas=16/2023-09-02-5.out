nohup: ignoring input
[2023-09-03 01:59:12,838] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[2023-09-03 01:59:16,982] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-03 01:59:17,026] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-03 01:59:17,036] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-09-03 01:59:17,049] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Using xformers
Using xformers
Initializing accelerator...
[2023-09-03 01:59:18,510] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-03 01:59:18,510] [INFO] [comm.py:616:init_distributed] cdb=None
Initializing accelerator...
[2023-09-03 01:59:18,524] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-03 01:59:18,524] [INFO] [comm.py:616:init_distributed] cdb=None
[2023-09-03 01:59:18,524] [INFO] [comm.py:643:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
Using xformers
Initializing accelerator...
Using xformers
[2023-09-03 01:59:18,668] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-03 01:59:18,668] [INFO] [comm.py:616:init_distributed] cdb=None
Initializing accelerator...
[2023-09-03 01:59:18,687] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2023-09-03 01:59:18,687] [INFO] [comm.py:616:init_distributed] cdb=None
09/03/2023 01:59:18 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 1
Local process index: 1
Device: cuda:1

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

09/03/2023 01:59:18 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 2
Local process index: 2
Device: cuda:2

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

09/03/2023 01:59:18 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 3
Local process index: 3
Device: cuda:3

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

accelerator.state = Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

09/03/2023 01:59:18 - INFO - __main__ - Distributed environment: DEEPSPEED  Backend: nccl
Num processes: 4
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: bf16
ds_config: {'bf16': {'enabled': True}, 'zero_optimization': {'stage': 3, 'overlap_comm': True, 'contiguous_gradients': True, 'sub_group_size': 1000000000.0, 'reduce_bucket_size': 'auto', 'stage3_prefetch_bucket_size': 'auto', 'stage3_param_persistence_threshold': 'auto', 'stage3_max_live_parameters': 1000000000.0, 'stage3_max_reuse_distance': 1000000000.0, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_accumulation_steps': 1, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'wall_clock_breakdown': False, 'fp16': {'enabled': False}}

09/03/2023 01:59:23 - DEBUG - evaluate.loading - Checking /data/users/zhangjunlei/tyx/.cache/huggingface/evaluate/downloads/96cba97f346e44af314163a75259842d567a1e87cf5b208754598a47f8c5f531.cfd6b2fbd44256c2b82392f9e38ab60b0f49c187db643eb761fb625fe8a3303c.py for additional imports.
09/03/2023 01:59:23 - DEBUG - evaluate.loading - Created importable dataset file at /data/users/zhangjunlei/tyx/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14/accuracy.py
09/03/2023 01:59:26 - DEBUG - evaluate.loading - Checking /data/users/zhangjunlei/tyx/.cache/huggingface/evaluate/downloads/498d31a4e66ca154bf5332fcbc8dd35c18a5ea36090d6be3b2d3aacc7794d5cc.39d17ba2a627a7569cf0b5b78be67e3176df05857da937b236a4ee081bbb92ec.py for additional imports.
09/03/2023 01:59:26 - DEBUG - evaluate.loading - Created importable dataset file at /data/users/zhangjunlei/tyx/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/0ca73f6cf92ef5a268320c697f7b940d1030f8471714bffdb6856c641b818974/f1.py
09/03/2023 01:59:28 - INFO - evaluate.utils.file_utils - HEAD request to https://huggingface.co/spaces/evaluate-metric/precision/resolve/v0.4.0/precision.py timed out, retrying... [1.0]
09/03/2023 01:59:30 - DEBUG - evaluate.loading - Checking /data/users/zhangjunlei/tyx/.cache/huggingface/evaluate/downloads/3475eb8bf47bed300d80c02f82bb340aa0cb078031fbd39c731005d74d707c24.68cf5e93118a075768a83fb255d6e1e2ed7c1a6a6c2a15efc3bdb64051e98654.py for additional imports.
09/03/2023 01:59:30 - DEBUG - evaluate.loading - Created importable dataset file at /data/users/zhangjunlei/tyx/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/4e7f439a346715f68500ce6f2be82bf3272abd3f20bdafd203a2c4f85b61dd5f/precision.py
09/03/2023 01:59:33 - DEBUG - evaluate.loading - Checking /data/users/zhangjunlei/tyx/.cache/huggingface/evaluate/downloads/89340037b5d34271e1522e5ad2308e9d050b495fa7ae88b2fa45a58cc24bf20f.e9198607b86fd02007e38b8f5a9af833e8066df08c633f857615896edf80f24d.py for additional imports.
09/03/2023 01:59:33 - DEBUG - evaluate.loading - Created importable dataset file at /data/users/zhangjunlei/tyx/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/e40e6e98d18ff3f210f4d0b26fa721bfaa80704b1fdf890fa551cfabf94fc185/recall.py
loading configuration file /data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936/config.json
Model config LlamaConfig {
  "_name_or_path": "/data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 5120,
  "initializer_range": 0.02,
  "intermediate_size": 13824,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 40,
  "num_hidden_layers": 40,
  "num_key_value_heads": 40,
  "pad_token_id": 0,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "tie_word_embeddings": false,
  "torch_dtype": "float16",
  "transformers_version": "4.31.0",
  "use_cache": true,
  "vocab_size": 32000
}

loading file tokenizer.model
loading file added_tokens.json
loading file special_tokens_map.json
loading file tokenizer_config.json
You are using the legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This means that tokens that come after special tokens will not be properly handled. We recommend you to read the related pull request available at https://github.com/huggingface/transformers/pull/24565
Detected PIL version 10.0.0
loading weights file /data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936/model.safetensors.index.json
Detected DeepSpeed ZeRO-3: activating zero.init() for this model
Generate config GenerationConfig {
  "_from_model_config": true,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.31.0"
}

[2023-09-03 01:59:33,570] [INFO] [partition_parameters.py:326:__exit__] finished initializing model with 13.02B parameters
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.01it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.95it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.90it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:06<00:03,  3.52s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:06<00:03,  3.53s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:06<00:03,  3.55s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:08<00:16,  8.03s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  4.18s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  3.70s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  4.18s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  3.70s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  4.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:11<00:00,  3.75s/it]
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:16<00:08,  8.11s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:21<00:00,  6.71s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:21<00:00,  7.08s/it]
All model checkpoint weights were used when initializing LlamaForCausalLM.

All the weights of LlamaForCausalLM were initialized from the model checkpoint at /data/users/zhangjunlei/tyx/.cache/huggingface/hub/models--meta-llama--Llama-2-13b-hf/snapshots/db6b8eb1feabb38985fdf785a89895959e944936.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.
Generation config file not found, using a generation config created from the model config.
Sun Sep  3 01:59:54 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.48.07    Driver Version: 515.48.07    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  Off  | 00000000:12:00.0 Off |                    0 |
| N/A   31C    P0    66W / 400W |    547MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  Off  | 00000000:18:00.0 Off |                    0 |
| N/A   29C    P0    68W / 400W |  42207MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  Off  | 00000000:4A:00.0 Off |                    0 |
| N/A   31C    P0    72W / 400W |  42662MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  Off  | 00000000:4E:00.0 Off |                    0 |
| N/A   31C    P0    67W / 400W |   9867MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM...  Off  | 00000000:8A:00.0 Off |                    0 |
| N/A   37C    P0    96W / 400W |  45419MiB / 81920MiB |    100%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM...  Off  | 00000000:8F:00.0 Off |                    0 |
| N/A   36C    P0    92W / 400W |  45263MiB / 81920MiB |    100%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM...  Off  | 00000000:C6:00.0 Off |                    0 |
| N/A   34C    P0    94W / 400W |  45175MiB / 81920MiB |    100%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM...  Off  | 00000000:CA:00.0 Off |                    0 |
| N/A   35C    P0    71W / 400W |  23751MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A   2661157      C   python3                           545MiB |
|    1   N/A  N/A   2428060      C   .../diffusion_gan/bin/python    42203MiB |
|    2   N/A  N/A    187985      C   python                          37871MiB |
|    2   N/A  N/A   2661157      C   python3                          4789MiB |
|    3   N/A  N/A    115166      C   .../open-instruct/bin/python     9865MiB |
|    4   N/A  N/A    115167      C   .../open-instruct/bin/python    45417MiB |
|    5   N/A  N/A    115168      C   .../open-instruct/bin/python    45261MiB |
|    6   N/A  N/A    115169      C   .../open-instruct/bin/python    45173MiB |
|    7   N/A  N/A   2722693      C   python                          23747MiB |
+-----------------------------------------------------------------------------+

Assigning <s> to the bos_token key of the tokenizer
Assigning </s> to the eos_token key of the tokenizer
Assigning <unk> to the unk_token key of the tokenizer
Assigning <pad> to the pad_token key of the tokenizer
Adding <pad> to the vocabulary
09/03/2023 01:59:57 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 1
09/03/2023 01:59:57 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 2
09/03/2023 01:59:57 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 3
09/03/2023 01:59:59 - INFO - __main__ - Sample 55952 of the training set: {'input_ids': tensor([    1,   960,   395, 29916, 29985, 29906,   718, 29871, 29906, 29916,
          718, 29871, 29945, 29938,   338,   263,  7329,   310,   395, 29916,
        29985, 29946,   718,   349, 29916, 29985, 29906,   718,   660,  8209,
         1284,   395, 29925,   718,   660,  7449,    13, 29902,  8369,   393,
          278,  2183,  7329,   338,   263, 25904, 10159,   393,   947,   451,
          505,   738,  1855, 16778, 29892,  1951,   967,  2313, 20386,   424,
          338,  8178, 29889,    13,  4013,  2794,   393,   278,   916,  7329,
          310,   278, 10256,   293, 10159,  1818,   884,   367,   263, 25904,
        10159,   411,   694,  1855, 16778, 29892,  1951,  6467,   278, 10256,
          293, 10159,   723,   505,   472,  3203,  1023,  1855, 16778, 29889,
           13,  6295,   306,   508,  2436,   395, 29916, 29985, 29946,   718,
          349, 29916, 29985, 29906,   718,   660,   353,   313, 29916, 29985,
        29906,   718, 29871, 29906, 29916,   718, 29871, 29945,  5033, 29916,
        29985, 29906,   718,  4853,   718,   289,   511, 29938,   988,   395,
        29874, 29938,   322,   395, 29890, 29938,   526,   777, 17727,   304,
          367, 10087, 29889,    13, 29777,   292,   278,  1492, 29899,  3179,
         2625, 29892,   306,   679,   395, 29916, 29985, 29946,   718,   313,
        29906,   718,   263, 29897, 29916, 29985, 29941,   718,   313, 29945,
          718, 29871, 29906, 29874,   718,   289, 29897, 29916, 29985, 29906,
          718,   313, 29906, 29890,   718, 29871, 29945, 29874, 29897, 29916,
          718, 29871, 29945, 29890,  7449,    13,  1523,   862,   292,   278,
        16127,   310,   278,  1021, 10801,   310,   395, 29916, 29938,   373,
         1716, 11192, 29892,   306,   679,   263,  1788,   310,  3023, 10693,
        29901,    13, 29905,   463, 29912,  2520,  4044,    13, 29906,   718,
          263,  7878, 29871, 29900,  1966,    13, 29945,   718, 29871, 29906,
        29874,   718,   289,  7878,   349,  1966,    13, 29906, 29890,   718,
        29871, 29945, 29874,  7878, 29871, 29900,  1966,    13, 29945, 29890,
         7878,   660,    13, 29905,   355, 29912,  2520,  4044,    13, 13296,
         1747,   363,   395, 29874, 29938,   515,   278,   937,  6306, 29892,
          306,   679,   395, 29874,   353,   448, 29906,  7449,    13,  4035,
          303, 12937,   292,   445,   964,   278,  4654,  6306, 29892,   306,
          679,   395, 29906, 29890,   448, 29871, 29896, 29900,   353, 29871,
        29900,  8209,   470,   395, 29890,   353, 29871, 29945,  7449,    13,
         4035,   303, 12937,   292,  1438,  1819,   310,   395, 29874, 29938,
          322,   395, 29890, 29938,   964,   278,  1473,   322, 11582, 10693,
        29892,   306,   679,   395, 29925,   353, 29871, 29945, 29938,   322,
          395, 29984,   353, 29871, 29906, 29945,  7449,    13]), 'labels': tensor([-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, 6374, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, 6374, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 6374, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, 6374, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, 8178])}.
09/03/2023 01:59:59 - INFO - __main__ - Sample 12576 of the training set: {'input_ids': tensor([    1,   319,  4943,   270,   356, 29883,   801,   287,  1617,   338,
          263, 18635, 15680, 17143,  1617,   411, 29871, 29896, 29906,  4943,
        11137,   351,  7177, 17240,   322, 29871, 29906, 29900, 13791, 29889,
        29871,   960,  1023,  8359, 13791,   526, 10434,   472,  4036, 29892,
          825,   338,   278,  6976,   393,   278,  1196, 16791,   963, 12185,
         2768,   278,   270,   356, 29883,   801,   287,  1617, 29973,    13,
        29902,  1073,   393,   263,  4943,   270,   356, 29883,   801,   287,
         1617,   756, 29871, 29906, 29900, 13791, 29892,   577,   727,   526,
        29871, 29906, 29900,  6755, 29871, 29906,  5837,   304,  6755,   263,
         5101,   310, 13791, 29889,    13, 29902,   884,  1073,   393,   727,
          526, 29871, 29941, 29900, 12770,   297,   263,  4943,   270,   356,
        29883,   801,   287,  1617, 29892,   322,  1269,  7636,  4511, 29879,
         1023, 13791, 29889,    13,  6295,   565,   306,  6755,   385,  7636,
        29892,   278,  1196, 16791,   278, 13791,   674,  3804,   373,   278,
         7101,   310,   278,   270,   356, 29883,   801,   287,  1617, 29892,
          451,  2768,   372, 29889,    13,  7058,  2794,   306,   817,   304,
        19060,   278, 12770,   515,   278,  1950, 11000,   310, 13791, 29889,
           13,  8439,   526, 29871, 29906, 29900,  6755, 29871, 29906, 26134,
        29871, 29941, 29900,  5837,   304,  6755,   263,  5101,   310, 13791,
          393,   526,   451,  6631,   491,   385,  7636, 29889,    13]), 'labels': tensor([-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 6374, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 6374, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, 8178])}.
09/03/2023 01:59:59 - INFO - __main__ - Sample 27981 of the training set: {'input_ids': tensor([    1,   319,  5665,   310,  6374, 11920,   338, 13319,   491, 18028,
          278,   937, 29871, 29946, 29892,   769, 14993,  3262,   697, 29892,
        18028,   278,  2446, 29871, 29945, 29892, 14993,  3262, 29871, 29906,
        29892, 18028, 29871, 29953, 29892, 14993,  3262, 29871, 29941, 29892,
          322, 29892,   373,   278,   395, 29876, 29938,   386, 12541, 29892,
        18028,   395, 29876,   718, 29871, 29941, 29938,   322, 14993,  3262,
          395, 29876,  1504,   450,  5665, 16410, 29871, 29896, 29892, 29871,
        29906, 29892, 29871, 29941, 29892, 29871, 29946, 29892, 29871, 29953,
        29892, 29871, 29955, 29892, 29871, 29947, 29892, 29871, 29929, 29892,
        29871, 29896, 29900, 29892, 29871, 29896, 29941, 29889,  1724,   338,
          278, 29871, 29945, 29900, 29900, 29892, 29900, 29900, 29900,   386,
         1353,   297,   278,  5665, 29973,    13,  4013,  1108, 20789,   263,
         3287,   310, 21248, 29892,   577,   306,   864,   304,  1106,   363,
          263,  4766,   470,  7063,   393,   508,  1371,   592,  1284,   278,
        29871, 29945, 29900, 29900, 29892, 29900, 29900, 29900,   386,  1840,
         1728, 18028,   599,   278,  3517,  6743, 29889,    13, 29902,  8369,
          393,   278,  1353,   310,  4958,   297,  1269, 12541, 16415,   491,
          697, 29892,   322,   278,  1353,   310, 14993,  2986,  4958,   884,
        16415,   491,   697, 29889,    13,  6295,   278,  3001,  1353,   310,
         4958,  2298, 14993,  2986,  4958,   297,   278,   937,   395, 29876,
        29938, 24372,   338,    13,    13,  3997,    13, 29905,  2083,   648,
        29895, 29922, 29896,  2137, 29876,   313, 29895,   718, 29871, 29941,
          718,   413, 29897,   353,   320,  2083,   648, 29895, 29922, 29896,
         2137, 29876,   313, 29906, 29895,   718, 29871, 29941, 29897,   353,
        29871, 29906,   320,  2083,   648, 29895, 29922, 29896,  2137, 29876,
          413,   718, 29871, 29941, 29876,   353,   302, 29898, 29876,   718,
        29871, 29896, 29897,   718, 29871, 29941, 29876,   353,   302, 29985,
        29906,   718, 29871, 29946, 29876, 29889,    13]), 'labels': tensor([-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, 6374, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, 6374, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
        8178])}.
09/03/2023 01:59:59 - INFO - accelerate.accelerator - Since you passed both train and evaluation dataloader, `is_train_batch_min` (here True will decide the `train_batch_size` (2).
09/03/2023 01:59:59 - INFO - accelerate.accelerator - Updating DeepSpeed's gradient accumulation steps to 16 from 1.
[2023-09-03 01:59:59,017] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.10.0, git-hash=unknown, git-branch=unknown
09/03/2023 01:59:59 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 0
09/03/2023 01:59:59 - INFO - torch.distributed.distributed_c10d - Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
09/03/2023 01:59:59 - INFO - torch.distributed.distributed_c10d - Rank 3: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
09/03/2023 01:59:59 - INFO - torch.distributed.distributed_c10d - Rank 1: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
09/03/2023 01:59:59 - INFO - torch.distributed.distributed_c10d - Rank 2: Completed store-based barrier for key:store_based_barrier_key:2 with 4 nodes.
[2023-09-03 01:59:59,729] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-09-03 01:59:59,730] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the client Optimizer
[2023-09-03 01:59:59,730] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2023-09-03 01:59:59,745] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2023-09-03 01:59:59,745] [INFO] [utils.py:54:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2023-09-03 01:59:59,745] [INFO] [logging.py:96:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[2023-09-03 01:59:59,745] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 3 optimizer
[2023-09-03 01:59:59,900] [INFO] [utils.py:785:see_memory_usage] Stage 3 initialize beginning
[2023-09-03 01:59:59,901] [INFO] [utils.py:786:see_memory_usage] MA 6.75 GB         Max_MA 7.44 GB         CA 9.2 GB         Max_CA 9 GB 
[2023-09-03 01:59:59,901] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 75.91 GB, percent = 7.5%
[2023-09-03 01:59:59,902] [INFO] [stage3.py:117:__init__] Reduce bucket size 26214400
[2023-09-03 01:59:59,902] [INFO] [stage3.py:118:__init__] Prefetch bucket size 23592960
[2023-09-03 02:00:00,001] [INFO] [utils.py:785:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[2023-09-03 02:00:00,002] [INFO] [utils.py:786:see_memory_usage] MA 6.75 GB         Max_MA 6.75 GB         CA 9.2 GB         Max_CA 9 GB 
[2023-09-03 02:00:00,002] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 75.91 GB, percent = 7.5%
Parameter Offload: Total persistent parameters: 414720 in 81 params
[2023-09-03 02:00:00,121] [INFO] [utils.py:785:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[2023-09-03 02:00:00,122] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.83 GB         CA 9.2 GB         Max_CA 9 GB 
[2023-09-03 02:00:00,122] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 75.91 GB, percent = 7.5%
[2023-09-03 02:00:00,223] [INFO] [utils.py:785:see_memory_usage] Before creating fp16 partitions
[2023-09-03 02:00:00,223] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.29 GB         CA 9.2 GB         Max_CA 9 GB 
[2023-09-03 02:00:00,224] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 75.91 GB, percent = 7.5%
[2023-09-03 02:00:04,831] [INFO] [utils.py:785:see_memory_usage] After creating fp16 partitions: 4
[2023-09-03 02:00:04,831] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.29 GB         CA 6.89 GB         Max_CA 9 GB 
[2023-09-03 02:00:04,832] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 94.09 GB, percent = 9.3%
[2023-09-03 02:00:04,956] [INFO] [utils.py:785:see_memory_usage] Before creating fp32 partitions
[2023-09-03 02:00:04,957] [INFO] [utils.py:786:see_memory_usage] MA 6.29 GB         Max_MA 6.29 GB         CA 6.89 GB         Max_CA 7 GB 
[2023-09-03 02:00:04,957] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 90.04 GB, percent = 8.9%
[2023-09-03 02:00:05,109] [INFO] [utils.py:785:see_memory_usage] After creating fp32 partitions
[2023-09-03 02:00:05,110] [INFO] [utils.py:786:see_memory_usage] MA 18.42 GB         Max_MA 19.43 GB         CA 21.9 GB         Max_CA 22 GB 
[2023-09-03 02:00:05,110] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 88.05 GB, percent = 8.7%
[2023-09-03 02:00:06,155] [INFO] [utils.py:785:see_memory_usage] Before initializing optimizer states
[2023-09-03 02:00:06,156] [INFO] [utils.py:786:see_memory_usage] MA 18.42 GB         Max_MA 18.42 GB         CA 21.9 GB         Max_CA 22 GB 
[2023-09-03 02:00:06,156] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 75.89 GB, percent = 7.5%
[2023-09-03 02:00:06,326] [INFO] [utils.py:785:see_memory_usage] After initializing optimizer states
[2023-09-03 02:00:06,326] [INFO] [utils.py:786:see_memory_usage] MA 42.66 GB         Max_MA 52.24 GB         CA 63.22 GB         Max_CA 63 GB 
[2023-09-03 02:00:06,326] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 75.89 GB, percent = 7.5%
[2023-09-03 02:00:06,365] [INFO] [stage3.py:424:_setup_for_real_optimizer] optimizer state initialized
[2023-09-03 02:00:06,631] [INFO] [utils.py:785:see_memory_usage] After initializing ZeRO optimizer
[2023-09-03 02:00:06,632] [INFO] [utils.py:786:see_memory_usage] MA 48.77 GB         Max_MA 49.38 GB         CA 70.3 GB         Max_CA 70 GB 
[2023-09-03 02:00:06,632] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 75.94 GB, percent = 7.5%
[2023-09-03 02:00:06,632] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2023-09-03 02:00:06,632] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2023-09-03 02:00:06,632] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2023-09-03 02:00:06,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[(0.9, 0.999)]
[2023-09-03 02:00:06,633] [INFO] [config.py:960:print] DeepSpeedEngine configuration:
[2023-09-03 02:00:06,633] [INFO] [config.py:964:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-09-03 02:00:06,633] [INFO] [config.py:964:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-09-03 02:00:06,633] [INFO] [config.py:964:print]   amp_enabled .................. False
[2023-09-03 02:00:06,633] [INFO] [config.py:964:print]   amp_params ................... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   bfloat16_enabled ............. True
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   checkpoint_parallel_write_pipeline  False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   checkpoint_tag_validation_enabled  True
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   checkpoint_tag_validation_fail  False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f135a9863b0>
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   communication_data_type ...... None
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   curriculum_enabled_legacy .... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   curriculum_params_legacy ..... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   data_efficiency_enabled ...... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   dataloader_drop_last ......... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   disable_allgather ............ False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   dump_state ................... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   dynamic_loss_scale_args ...... None
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_enabled ........... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_gas_boundary_resolution  1
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_layer_num ......... 0
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_max_iter .......... 100
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_stability ......... 1e-06
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_tol ............... 0.01
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   eigenvalue_verbose ........... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   elasticity_enabled ........... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   fp16_auto_cast ............... None
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   fp16_enabled ................. False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   fp16_master_weights_and_gradients  False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   global_rank .................. 0
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   grad_accum_dtype ............. None
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   gradient_accumulation_steps .. 16
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   gradient_clipping ............ 1.0
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   gradient_predivide_factor .... 1.0
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   initial_dynamic_scale ........ 1
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   load_universal_checkpoint .... False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   loss_scale ................... 1.0
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   memory_breakdown ............. False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   mics_hierarchial_params_gather  False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   mics_shard_size .............. -1
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-09-03 02:00:06,634] [INFO] [config.py:964:print]   optimizer_legacy_fusion ...... False
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   optimizer_name ............... None
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   optimizer_params ............. None
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   pld_enabled .................. False
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   pld_params ................... False
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   prescale_gradients ........... False
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   scheduler_name ............... None
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   scheduler_params ............. None
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   sparse_attention ............. None
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   sparse_gradients_enabled ..... False
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   steps_per_print .............. inf
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   train_batch_size ............. 128
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   train_micro_batch_size_per_gpu  2
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   use_node_local_storage ....... False
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   wall_clock_breakdown ......... False
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   world_size ................... 4
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   zero_allow_untested_optimizer  True
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=26214400 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=23592960 param_persistence_threshold=51200 model_persistence_threshold=sys.maxsize max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=True stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   zero_enabled ................. True
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   zero_force_ds_cpu_optimizer .. True
[2023-09-03 02:00:06,635] [INFO] [config.py:964:print]   zero_optimization_stage ...... 3
[2023-09-03 02:00:06,635] [INFO] [config.py:950:print_user_config]   json = {
    "bf16": {
        "enabled": true
    }, 
    "zero_optimization": {
        "stage": 3, 
        "overlap_comm": true, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09, 
        "reduce_bucket_size": 2.621440e+07, 
        "stage3_prefetch_bucket_size": 2.359296e+07, 
        "stage3_param_persistence_threshold": 5.120000e+04, 
        "stage3_max_live_parameters": 1.000000e+09, 
        "stage3_max_reuse_distance": 1.000000e+09, 
        "stage3_gather_16bit_weights_on_model_save": true
    }, 
    "gradient_accumulation_steps": 16, 
    "gradient_clipping": 1.0, 
    "steps_per_print": inf, 
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 2, 
    "wall_clock_breakdown": false, 
    "fp16": {
        "enabled": false
    }, 
    "zero_allow_untested_optimizer": true
}
Sun Sep  3 02:00:06 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.48.07    Driver Version: 515.48.07    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  Off  | 00000000:12:00.0 Off |                    0 |
| N/A   31C    P0    79W / 400W |    547MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  Off  | 00000000:18:00.0 Off |                    0 |
| N/A   29C    P0    69W / 400W |  42207MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  Off  | 00000000:4A:00.0 Off |                    0 |
| N/A   31C    P0    73W / 400W |  42662MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  Off  | 00000000:4E:00.0 Off |                    0 |
| N/A   32C    P0    85W / 400W |  73949MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM...  Off  | 00000000:8A:00.0 Off |                    0 |
| N/A   36C    P0    93W / 400W |  74193MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM...  Off  | 00000000:8F:00.0 Off |                    0 |
| N/A   35C    P0    84W / 400W |  75011MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM...  Off  | 00000000:C6:00.0 Off |                    0 |
| N/A   32C    P0    73W / 400W |  74627MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM...  Off  | 00000000:CA:00.0 Off |                    0 |
| N/A   35C    P0    84W / 400W |  23751MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A   2661157      C   python3                           545MiB |
|    1   N/A  N/A   2428060      C   .../diffusion_gan/bin/python    42203MiB |
|    2   N/A  N/A    187985      C   python                          37871MiB |
|    2   N/A  N/A   2661157      C   python3                          4789MiB |
|    3   N/A  N/A    115166      C   .../open-instruct/bin/python    73947MiB |
|    4   N/A  N/A    115167      C   .../open-instruct/bin/python    74557MiB |
|    5   N/A  N/A    115168      C   .../open-instruct/bin/python    75009MiB |
|    6   N/A  N/A    115169      C   .../open-instruct/bin/python    74625MiB |
|    7   N/A  N/A   2722693      C   python                          23747MiB |
+-----------------------------------------------------------------------------+

wandb: Currently logged in as: kidrain61. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.15.9
wandb: Run data is saved locally in /data/users/zhangjunlei/tyx/wandb/wandb/run-20230903_020014-ns3066qu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run llama2-13b-direct-prediction-002validation-bs=128-gas=16
wandb: ⭐️ View project at https://wandb.ai/kidrain61/step-reward
wandb: 🚀 View run at https://wandb.ai/kidrain61/step-reward/runs/ns3066qu
09/03/2023 02:00:19 - INFO - __main__ - ***** Running training *****
09/03/2023 02:00:19 - INFO - __main__ -   Num examples = 85194
09/03/2023 02:00:19 - INFO - __main__ -   Num Epochs = 100
09/03/2023 02:00:19 - INFO - __main__ -   Instantaneous batch size per device = 2
09/03/2023 02:00:19 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 128
09/03/2023 02:00:19 - INFO - __main__ -   Gradient Accumulation steps = 16
09/03/2023 02:00:19 - INFO - __main__ -   Total optimization steps = 66600
09/03/2023 02:00:19 - INFO - __main__ - ***** Running Validation *****
Evaluating:   0%|          | 0/228 [00:00<?, ?it/s]step: 0
step: 1
Evaluating:   1%|          | 2/228 [00:01<02:41,  1.40it/s]step: 2
Evaluating:   1%|▏         | 3/228 [00:01<02:10,  1.73it/s]step: 3
Evaluating:   2%|▏         | 4/228 [00:02<01:49,  2.05it/s]step: 4
Evaluating:   2%|▏         | 5/228 [00:02<01:37,  2.29it/s]step: 5
Evaluating:   3%|▎         | 6/228 [00:02<01:29,  2.47it/s]step: 6
Evaluating:   3%|▎         | 7/228 [00:03<01:25,  2.60it/s]step: 7
Evaluating:   4%|▎         | 8/228 [00:03<01:21,  2.71it/s]step: 8
Evaluating:   4%|▍         | 9/228 [00:03<01:18,  2.78it/s]step: 9
Evaluating:   4%|▍         | 10/228 [00:04<01:16,  2.83it/s]step: 10
Evaluating:   5%|▍         | 11/228 [00:04<01:15,  2.88it/s]step: 11
Evaluating:   5%|▌         | 12/228 [00:04<01:14,  2.91it/s]step: 12
Evaluating:   6%|▌         | 13/228 [00:05<01:13,  2.92it/s]step: 13
Evaluating:   6%|▌         | 14/228 [00:05<01:12,  2.94it/s]step: 14
Evaluating:   7%|▋         | 15/228 [00:05<01:12,  2.95it/s]step: 15
Evaluating:   7%|▋         | 16/228 [00:06<01:12,  2.94it/s]step: 16
Evaluating:   7%|▋         | 17/228 [00:06<01:11,  2.95it/s]step: 17
Evaluating:   8%|▊         | 18/228 [00:06<01:11,  2.95it/s]step: 18
Evaluating:   8%|▊         | 19/228 [00:07<01:10,  2.96it/s]step: 19
Evaluating:   9%|▉         | 20/228 [00:07<01:10,  2.95it/s]step: 20
Evaluating:   9%|▉         | 21/228 [00:07<01:10,  2.95it/s]step: 21
Evaluating:  10%|▉         | 22/228 [00:08<01:09,  2.96it/s]step: 22
Evaluating:  10%|█         | 23/228 [00:08<01:09,  2.95it/s]step: 23
Evaluating:  11%|█         | 24/228 [00:08<01:08,  2.96it/s]step: 24
Evaluating:  11%|█         | 25/228 [00:09<01:08,  2.96it/s]step: 25
Evaluating:  11%|█▏        | 26/228 [00:09<01:08,  2.96it/s]step: 26
Evaluating:  12%|█▏        | 27/228 [00:09<01:08,  2.96it/s]step: 27
Evaluating:  12%|█▏        | 28/228 [00:10<01:07,  2.96it/s]step: 28
Evaluating:  13%|█▎        | 29/228 [00:10<01:07,  2.96it/s]step: 29
Evaluating:  13%|█▎        | 30/228 [00:10<01:06,  2.97it/s]step: 30
Evaluating:  14%|█▎        | 31/228 [00:11<01:07,  2.93it/s]step: 31
Evaluating:  14%|█▍        | 32/228 [00:11<01:06,  2.94it/s]step: 32
Evaluating:  14%|█▍        | 33/228 [00:11<01:06,  2.95it/s]step: 33
Evaluating:  15%|█▍        | 34/228 [00:12<01:06,  2.94it/s]step: 34
Evaluating:  15%|█▌        | 35/228 [00:12<01:05,  2.95it/s]step: 35
Evaluating:  16%|█▌        | 36/228 [00:12<01:05,  2.95it/s]step: 36
Evaluating:  16%|█▌        | 37/228 [00:13<01:04,  2.96it/s]step: 37
Evaluating:  17%|█▋        | 38/228 [00:13<01:04,  2.96it/s]step: 38
Evaluating:  17%|█▋        | 39/228 [00:13<01:03,  2.96it/s]step: 39
Evaluating:  18%|█▊        | 40/228 [00:14<01:03,  2.95it/s]step: 40
Evaluating:  18%|█▊        | 41/228 [00:14<01:03,  2.95it/s]step: 41
Evaluating:  18%|█▊        | 42/228 [00:15<01:02,  2.96it/s]step: 42
Evaluating:  19%|█▉        | 43/228 [00:15<01:02,  2.96it/s]step: 43
Evaluating:  19%|█▉        | 44/228 [00:15<01:02,  2.96it/s]step: 44
Evaluating:  20%|█▉        | 45/228 [00:16<01:01,  2.96it/s]step: 45
Evaluating:  20%|██        | 46/228 [00:16<01:01,  2.96it/s]step: 46
Evaluating:  21%|██        | 47/228 [00:16<01:01,  2.96it/s]step: 47
Evaluating:  21%|██        | 48/228 [00:17<01:00,  2.96it/s]step: 48
Evaluating:  21%|██▏       | 49/228 [00:17<01:00,  2.95it/s]step: 49
Evaluating:  22%|██▏       | 50/228 [00:17<01:00,  2.95it/s]step: 50
Evaluating:  22%|██▏       | 51/228 [00:18<01:00,  2.94it/s]step: 51
Evaluating:  23%|██▎       | 52/228 [00:18<00:59,  2.95it/s]step: 52
Evaluating:  23%|██▎       | 53/228 [00:18<00:59,  2.95it/s]step: 53
Evaluating:  24%|██▎       | 54/228 [00:19<00:58,  2.95it/s]step: 54
Evaluating:  24%|██▍       | 55/228 [00:19<00:58,  2.95it/s]step: 55
Evaluating:  25%|██▍       | 56/228 [00:19<00:58,  2.95it/s]step: 56
Evaluating:  25%|██▌       | 57/228 [00:20<00:57,  2.95it/s]step: 57
Evaluating:  25%|██▌       | 58/228 [00:20<00:57,  2.96it/s]step: 58
Evaluating:  26%|██▌       | 59/228 [00:20<00:57,  2.95it/s]step: 59
Evaluating:  26%|██▋       | 60/228 [00:21<00:56,  2.95it/s]step: 60
Evaluating:  27%|██▋       | 61/228 [00:21<00:56,  2.95it/s]step: 61
Evaluating:  27%|██▋       | 62/228 [00:21<00:56,  2.95it/s]step: 62
Evaluating:  28%|██▊       | 63/228 [00:22<00:55,  2.96it/s]step: 63
Evaluating:  28%|██▊       | 64/228 [00:22<00:55,  2.96it/s]step: 64
Evaluating:  29%|██▊       | 65/228 [00:22<00:55,  2.96it/s]step: 65
Evaluating:  29%|██▉       | 66/228 [00:23<00:54,  2.96it/s]step: 66
Evaluating:  29%|██▉       | 67/228 [00:23<00:54,  2.94it/s]step: 67
Evaluating:  30%|██▉       | 68/228 [00:23<00:54,  2.94it/s]step: 68
Evaluating:  30%|███       | 69/228 [00:24<00:53,  2.95it/s]step: 69
Evaluating:  31%|███       | 70/228 [00:24<00:53,  2.95it/s]step: 70
Evaluating:  31%|███       | 71/228 [00:24<00:53,  2.93it/s]step: 71
Evaluating:  32%|███▏      | 72/228 [00:25<00:52,  2.94it/s]step: 72
Evaluating:  32%|███▏      | 73/228 [00:25<00:53,  2.92it/s]step: 73
Evaluating:  32%|███▏      | 74/228 [00:25<00:52,  2.93it/s]step: 74
Evaluating:  33%|███▎      | 75/228 [00:26<00:52,  2.94it/s]step: 75
Evaluating:  33%|███▎      | 76/228 [00:26<00:51,  2.94it/s]step: 76
Evaluating:  34%|███▍      | 77/228 [00:26<00:51,  2.95it/s]step: 77
Evaluating:  34%|███▍      | 78/228 [00:27<00:51,  2.94it/s]step: 78
Evaluating:  35%|███▍      | 79/228 [00:27<00:50,  2.94it/s]step: 79
Evaluating:  35%|███▌      | 80/228 [00:27<00:50,  2.94it/s]step: 80
Evaluating:  36%|███▌      | 81/228 [00:28<00:49,  2.95it/s]step: 81
Evaluating:  36%|███▌      | 82/228 [00:28<00:49,  2.95it/s]step: 82
Evaluating:  36%|███▋      | 83/228 [00:28<00:49,  2.96it/s]step: 83
Evaluating:  37%|███▋      | 84/228 [00:29<00:48,  2.95it/s]step: 84
Evaluating:  37%|███▋      | 85/228 [00:29<00:48,  2.95it/s]step: 85
Evaluating:  38%|███▊      | 86/228 [00:29<00:48,  2.96it/s]step: 86
Evaluating:  38%|███▊      | 87/228 [00:30<00:47,  2.96it/s]step: 87
Evaluating:  39%|███▊      | 88/228 [00:30<00:47,  2.96it/s]step: 88
Evaluating:  39%|███▉      | 89/228 [00:30<00:47,  2.95it/s]step: 89
Evaluating:  39%|███▉      | 90/228 [00:31<00:46,  2.96it/s]step: 90
Evaluating:  40%|███▉      | 91/228 [00:31<00:46,  2.96it/s]step: 91
Evaluating:  40%|████      | 92/228 [00:31<00:46,  2.91it/s]step: 92
Evaluating:  41%|████      | 93/228 [00:32<00:47,  2.84it/s]step: 93
Evaluating:  41%|████      | 94/228 [00:32<00:46,  2.87it/s]step: 94
Evaluating:  42%|████▏     | 95/228 [00:33<00:46,  2.89it/s]step: 95
Evaluating:  42%|████▏     | 96/228 [00:33<00:45,  2.92it/s]step: 96
Evaluating:  43%|████▎     | 97/228 [00:33<00:44,  2.93it/s]step: 97
Evaluating:  43%|████▎     | 98/228 [00:34<00:44,  2.94it/s]step: 98
Evaluating:  43%|████▎     | 99/228 [00:34<00:43,  2.95it/s]step: 99
Evaluating:  44%|████▍     | 100/228 [00:34<00:43,  2.95it/s]step: 100
Evaluating:  44%|████▍     | 101/228 [00:35<00:43,  2.94it/s]step: 101
Evaluating:  45%|████▍     | 102/228 [00:35<00:42,  2.95it/s]step: 102
Evaluating:  45%|████▌     | 103/228 [00:35<00:42,  2.95it/s]step: 103
Evaluating:  46%|████▌     | 104/228 [00:36<00:41,  2.96it/s]step: 104
Evaluating:  46%|████▌     | 105/228 [00:36<00:41,  2.96it/s]step: 105
Evaluating:  46%|████▋     | 106/228 [00:36<00:41,  2.96it/s]step: 106
Evaluating:  47%|████▋     | 107/228 [00:37<00:40,  2.96it/s]step: 107
Evaluating:  47%|████▋     | 108/228 [00:37<00:40,  2.96it/s]step: 108
Evaluating:  48%|████▊     | 109/228 [00:37<00:40,  2.96it/s]step: 109
Evaluating:  48%|████▊     | 110/228 [00:38<00:39,  2.96it/s]step: 110
Evaluating:  49%|████▊     | 111/228 [00:38<00:39,  2.96it/s]step: 111
Evaluating:  49%|████▉     | 112/228 [00:38<00:39,  2.96it/s]step: 112
Evaluating:  50%|████▉     | 113/228 [00:39<00:38,  2.95it/s]step: 113
Evaluating:  50%|█████     | 114/228 [00:39<00:38,  2.95it/s]step: 114
Evaluating:  50%|█████     | 115/228 [00:39<00:38,  2.95it/s]step: 115
Evaluating:  51%|█████     | 116/228 [00:40<00:37,  2.95it/s]step: 116
Evaluating:  51%|█████▏    | 117/228 [00:40<00:37,  2.95it/s]step: 117
Evaluating:  52%|█████▏    | 118/228 [00:40<00:37,  2.95it/s]step: 118
Evaluating:  52%|█████▏    | 119/228 [00:41<00:36,  2.95it/s]step: 119
Evaluating:  53%|█████▎    | 120/228 [00:41<00:36,  2.95it/s]step: 120
Evaluating:  53%|█████▎    | 121/228 [00:41<00:36,  2.91it/s]step: 121
Evaluating:  54%|█████▎    | 122/228 [00:42<00:36,  2.92it/s]step: 122
Evaluating:  54%|█████▍    | 123/228 [00:42<00:35,  2.93it/s]step: 123
Evaluating:  54%|█████▍    | 124/228 [00:42<00:35,  2.95it/s]step: 124
Evaluating:  55%|█████▍    | 125/228 [00:43<00:34,  2.95it/s]step: 125
Evaluating:  55%|█████▌    | 126/228 [00:43<00:34,  2.94it/s]step: 126
Evaluating:  56%|█████▌    | 127/228 [00:43<00:34,  2.95it/s]step: 127
Evaluating:  56%|█████▌    | 128/228 [00:44<00:34,  2.94it/s]step: 128
Evaluating:  57%|█████▋    | 129/228 [00:44<00:33,  2.94it/s]step: 129
Evaluating:  57%|█████▋    | 130/228 [00:44<00:33,  2.95it/s]step: 130
Evaluating:  57%|█████▋    | 131/228 [00:45<00:32,  2.95it/s]step: 131
Evaluating:  58%|█████▊    | 132/228 [00:45<00:32,  2.95it/s]step: 132
Evaluating:  58%|█████▊    | 133/228 [00:45<00:32,  2.95it/s]step: 133
Evaluating:  59%|█████▉    | 134/228 [00:46<00:31,  2.95it/s]step: 134
Evaluating:  59%|█████▉    | 135/228 [00:46<00:31,  2.94it/s]step: 135
Evaluating:  60%|█████▉    | 136/228 [00:46<00:31,  2.94it/s]step: 136
Evaluating:  60%|██████    | 137/228 [00:47<00:30,  2.94it/s]step: 137
Evaluating:  61%|██████    | 138/228 [00:47<00:30,  2.94it/s]step: 138
Evaluating:  61%|██████    | 139/228 [00:47<00:31,  2.82it/s]step: 139
Evaluating:  61%|██████▏   | 140/228 [00:48<00:31,  2.82it/s]step: 140
Evaluating:  62%|██████▏   | 141/228 [00:48<00:30,  2.87it/s]step: 141
Evaluating:  62%|██████▏   | 142/228 [00:49<00:29,  2.90it/s]step: 142
Evaluating:  63%|██████▎   | 143/228 [00:49<00:29,  2.89it/s]step: 143
Evaluating:  63%|██████▎   | 144/228 [00:49<00:28,  2.91it/s]step: 144
Evaluating:  64%|██████▎   | 145/228 [00:50<00:28,  2.92it/s]step: 145
Evaluating:  64%|██████▍   | 146/228 [00:50<00:27,  2.93it/s]step: 146
Evaluating:  64%|██████▍   | 147/228 [00:50<00:27,  2.94it/s]step: 147
Evaluating:  65%|██████▍   | 148/228 [00:51<00:27,  2.93it/s]step: 148
Evaluating:  65%|██████▌   | 149/228 [00:51<00:26,  2.94it/s]step: 149
Evaluating:  66%|██████▌   | 150/228 [00:51<00:26,  2.93it/s]step: 150
Evaluating:  66%|██████▌   | 151/228 [00:52<00:26,  2.94it/s]step: 151
Evaluating:  67%|██████▋   | 152/228 [00:52<00:25,  2.94it/s]step: 152
Evaluating:  67%|██████▋   | 153/228 [00:52<00:25,  2.94it/s]step: 153
Evaluating:  68%|██████▊   | 154/228 [00:53<00:25,  2.94it/s]step: 154
Evaluating:  68%|██████▊   | 155/228 [00:53<00:24,  2.94it/s]step: 155
Evaluating:  68%|██████▊   | 156/228 [00:53<00:24,  2.94it/s]step: 156
Evaluating:  69%|██████▉   | 157/228 [00:54<00:24,  2.95it/s]step: 157
Evaluating:  69%|██████▉   | 158/228 [00:54<00:23,  2.95it/s]step: 158
Evaluating:  70%|██████▉   | 159/228 [00:54<00:23,  2.95it/s]step: 159
Evaluating:  70%|███████   | 160/228 [00:55<00:23,  2.95it/s]step: 160
Evaluating:  71%|███████   | 161/228 [00:55<00:22,  2.91it/s]step: 161
Evaluating:  71%|███████   | 162/228 [00:55<00:22,  2.93it/s]step: 162
Evaluating:  71%|███████▏  | 163/228 [00:56<00:22,  2.93it/s]step: 163
Evaluating:  72%|███████▏  | 164/228 [00:56<00:21,  2.93it/s]step: 164
Evaluating:  72%|███████▏  | 165/228 [00:56<00:21,  2.94it/s]step: 165
Evaluating:  73%|███████▎  | 166/228 [00:57<00:21,  2.95it/s]step: 166
Evaluating:  73%|███████▎  | 167/228 [00:57<00:20,  2.95it/s]step: 167
Evaluating:  74%|███████▎  | 168/228 [00:57<00:20,  2.96it/s]step: 168
Evaluating:  74%|███████▍  | 169/228 [00:58<00:19,  2.96it/s]step: 169
Evaluating:  75%|███████▍  | 170/228 [00:58<00:19,  2.94it/s]step: 170
Evaluating:  75%|███████▌  | 171/228 [00:58<00:19,  2.94it/s]step: 171
Evaluating:  75%|███████▌  | 172/228 [00:59<00:19,  2.94it/s]step: 172
Evaluating:  76%|███████▌  | 173/228 [00:59<00:18,  2.95it/s]step: 173
Evaluating:  76%|███████▋  | 174/228 [00:59<00:18,  2.94it/s]step: 174
Evaluating:  77%|███████▋  | 175/228 [01:00<00:18,  2.94it/s]step: 175
Evaluating:  77%|███████▋  | 176/228 [01:00<00:17,  2.95it/s]step: 176
Evaluating:  78%|███████▊  | 177/228 [01:00<00:17,  2.96it/s]step: 177
Evaluating:  78%|███████▊  | 178/228 [01:01<00:16,  2.96it/s]step: 178
Evaluating:  79%|███████▊  | 179/228 [01:01<00:16,  2.94it/s]step: 179
Evaluating:  79%|███████▉  | 180/228 [01:01<00:16,  2.95it/s]step: 180
Evaluating:  79%|███████▉  | 181/228 [01:02<00:15,  2.95it/s]step: 181
Evaluating:  80%|███████▉  | 182/228 [01:02<00:15,  2.95it/s]step: 182
Evaluating:  80%|████████  | 183/228 [01:02<00:15,  2.94it/s]step: 183
Evaluating:  81%|████████  | 184/228 [01:03<00:14,  2.95it/s]step: 184
Evaluating:  81%|████████  | 185/228 [01:03<00:14,  2.94it/s]step: 185
Evaluating:  82%|████████▏ | 186/228 [01:03<00:14,  2.94it/s]step: 186
Evaluating:  82%|████████▏ | 187/228 [01:04<00:13,  2.94it/s]step: 187
Evaluating:  82%|████████▏ | 188/228 [01:04<00:13,  2.94it/s]step: 188
Evaluating:  83%|████████▎ | 189/228 [01:04<00:13,  2.95it/s]step: 189
Evaluating:  83%|████████▎ | 190/228 [01:05<00:12,  2.93it/s]step: 190
Evaluating:  84%|████████▍ | 191/228 [01:05<00:12,  2.94it/s]step: 191
Evaluating:  84%|████████▍ | 192/228 [01:06<00:12,  2.94it/s]step: 192
Evaluating:  85%|████████▍ | 193/228 [01:06<00:11,  2.94it/s]step: 193
Evaluating:  85%|████████▌ | 194/228 [01:06<00:11,  2.94it/s]step: 194
Evaluating:  86%|████████▌ | 195/228 [01:07<00:11,  2.94it/s]step: 195
Evaluating:  86%|████████▌ | 196/228 [01:07<00:10,  2.94it/s]step: 196
Evaluating:  86%|████████▋ | 197/228 [01:07<00:10,  2.95it/s]step: 197
Evaluating:  87%|████████▋ | 198/228 [01:08<00:10,  2.95it/s]step: 198
Evaluating:  87%|████████▋ | 199/228 [01:08<00:09,  2.95it/s]step: 199
Evaluating:  88%|████████▊ | 200/228 [01:08<00:09,  2.95it/s]step: 200
Evaluating:  88%|████████▊ | 201/228 [01:09<00:09,  2.95it/s]step: 201
Evaluating:  89%|████████▊ | 202/228 [01:09<00:08,  2.95it/s]step: 202
Evaluating:  89%|████████▉ | 203/228 [01:09<00:08,  2.93it/s]step: 203
Evaluating:  89%|████████▉ | 204/228 [01:10<00:08,  2.94it/s]step: 204
Evaluating:  90%|████████▉ | 205/228 [01:10<00:07,  2.93it/s]step: 205
Evaluating:  90%|█████████ | 206/228 [01:10<00:07,  2.94it/s]step: 206
Evaluating:  91%|█████████ | 207/228 [01:11<00:07,  2.94it/s]step: 207
Evaluating:  91%|█████████ | 208/228 [01:11<00:06,  2.94it/s]step: 208
Evaluating:  92%|█████████▏| 209/228 [01:11<00:06,  2.94it/s]step: 209
Evaluating:  92%|█████████▏| 210/228 [01:12<00:06,  2.94it/s]step: 210
Evaluating:  93%|█████████▎| 211/228 [01:12<00:05,  2.95it/s]step: 211
Evaluating:  93%|█████████▎| 212/228 [01:12<00:05,  2.95it/s]step: 212
Evaluating:  93%|█████████▎| 213/228 [01:13<00:05,  2.95it/s]step: 213
Evaluating:  94%|█████████▍| 214/228 [01:13<00:04,  2.94it/s]step: 214
Evaluating:  94%|█████████▍| 215/228 [01:13<00:04,  2.94it/s]step: 215
Evaluating:  95%|█████████▍| 216/228 [01:14<00:04,  2.93it/s]step: 216
Evaluating:  95%|█████████▌| 217/228 [01:14<00:03,  2.94it/s]step: 217
Evaluating:  96%|█████████▌| 218/228 [01:14<00:03,  2.95it/s]step: 218
Evaluating:  96%|█████████▌| 219/228 [01:15<00:03,  2.95it/s]step: 219
Evaluating:  96%|█████████▋| 220/228 [01:15<00:02,  2.94it/s]step: 220
Evaluating:  97%|█████████▋| 221/228 [01:15<00:02,  2.95it/s]step: 221
Evaluating:  97%|█████████▋| 222/228 [01:16<00:02,  2.94it/s]step: 222
Evaluating:  98%|█████████▊| 223/228 [01:16<00:01,  2.94it/s]step: 223
Evaluating:  98%|█████████▊| 224/228 [01:16<00:01,  2.95it/s]step: 224
Evaluating:  99%|█████████▊| 225/228 [01:17<00:01,  2.84it/s]step: 225
Evaluating:  99%|█████████▉| 226/228 [01:17<00:00,  2.88it/s]step: 226
Evaluating: 100%|█████████▉| 227/228 [01:17<00:00,  2.86it/s]step: 227
Evaluating: 100%|██████████| 228/228 [01:18<00:00,  2.89it/s]len(all_predictions) = 10801
all_predictions[:10] = [1, 1, -1, -1, 1, 1, 1, 1, 1, 1]
all_references[:10] = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
09/03/2023 02:01:38 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/accuracy/default/default_experiment-1-0.arrow
09/03/2023 02:01:38 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/f1/default/default_experiment-1-0.arrow
09/03/2023 02:01:38 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/f1/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/f1/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/f1/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/precision/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/precision/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/precision/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/precision/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/recall/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/recall/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/recall/default/default_experiment-1-0.arrow
09/03/2023 02:01:39 - INFO - evaluate.module - Removing /data/users/zhangjunlei/tyx/.cache/huggingface/metrics/recall/default/default_experiment-1-0.arrow
Evaluating: 100%|██████████| 228/228 [01:19<00:00,  2.86it/s]
09/03/2023 02:01:39 - INFO - __main__ -   Step: 0, Validation Metrics: {'prediction_1_num': 6869, 'prediction_-1_num': 3844, 'prediction_0_num': 88, 'reference_1_num': 8596, 'reference_0_num': 639, 'reference_-1_num': 1566, 'accuracy': 0.528099250069438, 'f1_micro': 0.528099250069438, 'f1_macro': 0.2851683448765023, 'f1_weighted': 0.5676741559014405, 'f1_1': 0.6845134173941156, 'f1_-1': 0.14898336414048058, 'f1_0': 0.02200825309491059, 'precision_micro': 0.528099250069438, 'precision_macro': 0.32210373379088364, 'precision_weighted': 0.6338331007872802, 'precision_1': 0.7705634007861406, 'precision_-1': 0.10483870967741936, 'precision_0': 0.09090909090909091, 'recall_micro': 0.528099250069438, 'recall_macro': 0.29520487486455066, 'recall_weighted': 0.528099250069438, 'recall_1': 0.6157515123313169, 'recall_-1': 0.25734355044699875, 'recall_0': 0.012519561815336464}
  0%|          | 0/66600 [00:00<?, ?it/s]Sun Sep  3 02:01:39 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.48.07    Driver Version: 515.48.07    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  Off  | 00000000:12:00.0 Off |                    0 |
| N/A   31C    P0    67W / 400W |    547MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  Off  | 00000000:18:00.0 Off |                    0 |
| N/A   30C    P0    84W / 400W |  42207MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  Off  | 00000000:4A:00.0 Off |                    0 |
| N/A   35C    P0    75W / 400W |  42662MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  Off  | 00000000:4E:00.0 Off |                    0 |
| N/A   44C    P0    75W / 400W |  79135MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM...  Off  | 00000000:8A:00.0 Off |                    0 |
| N/A   49C    P0    83W / 400W |  79303MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM...  Off  | 00000000:8F:00.0 Off |                    0 |
| N/A   46C    P0    75W / 400W |  79669MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM...  Off  | 00000000:C6:00.0 Off |                    0 |
| N/A   43C    P0    96W / 400W |  79727MiB / 81920MiB |    100%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM...  Off  | 00000000:CA:00.0 Off |                    0 |
| N/A   40C    P0    83W / 400W |  23751MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A   2661157      C   python3                           545MiB |
|    1   N/A  N/A   2428060      C   .../diffusion_gan/bin/python    42203MiB |
|    2   N/A  N/A    187985      C   python                          37871MiB |
|    2   N/A  N/A   2661157      C   python3                          4789MiB |
|    3   N/A  N/A    115166      C   .../open-instruct/bin/python    79133MiB |
|    4   N/A  N/A    115167      C   .../open-instruct/bin/python    79301MiB |
|    5   N/A  N/A    115168      C   .../open-instruct/bin/python    79667MiB |
|    6   N/A  N/A    115169      C   .../open-instruct/bin/python    79725MiB |
|    7   N/A  N/A   2722693      C   python                          23747MiB |
+-----------------------------------------------------------------------------+

[2023-09-03 02:02:04,631] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 1/66600 [00:25<467:17:35, 25.26s/it]09/03/2023 02:02:04 - INFO - __main__ -   Step: 1, LR: 1.0013768932281888e-08, Loss: 18.286109924316406
[2023-09-03 02:02:23,124] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 2/66600 [00:43<393:39:09, 21.28s/it]09/03/2023 02:02:23 - INFO - __main__ -   Step: 2, LR: 2.0027537864563777e-08, Loss: 18.08640480041504
[2023-09-03 02:02:41,896] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 3/66600 [01:02<372:27:54, 20.13s/it]09/03/2023 02:02:41 - INFO - __main__ -   Step: 3, LR: 3.0041306796845665e-08, Loss: 18.351486206054688
[2023-09-03 02:03:00,716] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 4/66600 [01:21<362:51:52, 19.62s/it]09/03/2023 02:03:00 - INFO - __main__ -   Step: 4, LR: 4.0055075729127554e-08, Loss: 18.186161041259766
[2023-09-03 02:03:19,444] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 5/66600 [01:40<356:56:14, 19.30s/it]09/03/2023 02:03:19 - INFO - __main__ -   Step: 5, LR: 5.006884466140944e-08, Loss: 18.334495544433594
[2023-09-03 02:03:38,156] [WARNING] [stage3.py:1898:step] 3 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
  0%|          | 6/66600 [01:58<353:15:33, 19.10s/it]09/03/2023 02:03:38 - INFO - __main__ -   Step: 6, LR: 6.008261359369133e-08, Loss: 18.269794464111328
